/**
  ******************************************************************************
  * @file    measure.c
  * @author  anirudhr
  * @brief   Computes various parameters of the input signal.
  ******************************************************************************
  */

/* Includes */
#include "measure.h"


uint8_t chSpectrum[ADC_TRIGBUF_SIZE];
const char measParamTexts[][5] = {"None", "Freq", "Duty", "Vrms", "Vmax", "Vmin", "Vpp ", "Vavg"};
Measure_TypeDef measure1, measure2, measure3, measure4;
static arm_rfft_fast_instance_f32 S_rfft_512;
static arm_cfft_instance_f32 S_cfft_1024;

static float32_t calcFreq(__IO uint8_t x[]);
static uint8_t calcDuty(__IO uint8_t x[]);
static uint8_t calcVrms(__IO uint8_t x[]);
static uint8_t calcVmax(__IO uint8_t x[]);
static uint8_t calcVmin(__IO uint8_t x[]);
static uint8_t calcVpp(__IO uint8_t x[]);
static uint8_t calcVavg(__IO uint8_t x[]);
static void czt(uint8_t x[], float32_t oup[], float32_t f1, float32_t f2, uint32_t N, uint32_t M, uint8_t useWindow);


/**
  * @brief  Initialize the FFT instances.
  * @param  None
  * @retval None
  */
void measure_init(void)
{
	arm_rfft_fast_init_f32(&S_rfft_512, 512);
	arm_cfft_init_f32(&S_cfft_1024, 1024);
}

/**
  * @brief  Calculate the given parameter of a particular channel signal.
  * @param  channel: source signal
  * @param  param: parameter to calculate
  * @retval calculated value
  */
float32_t calcMeasure(uint8_t channel, uint8_t param)
{
	__IO uint8_t* x;

	if(channel == CHANNEL1)
		x = (__IO uint8_t *)CH1_ADC_vals + ADC_PRETRIGBUF_SIZE;
	else
		x = (__IO uint8_t *)CH2_ADC_vals + ADC_PRETRIGBUF_SIZE;

	if(param == MEAS_FREQ)
		return calcFreq(x);
	else if(param == MEAS_DUTY)
		return calcDuty(x);
	else if(param == MEAS_VRMS)
		return calcVrms(x);
	else if(param == MEAS_VMAX)
		return calcVmax(x);
	else if(param == MEAS_VMIN)
		return calcVmin(x);
	else if(param == MEAS_VPP)
		return calcVpp(x);
	else if(param == MEAS_VAVG)
		return calcVavg(x);
	else
		return 0;

	return 0;
}

/**
* @brief  Calculate Frequency of signal.
* @param  x: input signal
* @retval calculated Frequency
*/
static float32_t calcFreq(__IO uint8_t x[])
{
	float32_t inp[512], oup[545];
	uint8_t xcpy[ADC_TRIGBUF_SIZE];
	float32_t maxmag, f1, f2;
	uint32_t maxidx, i;

	/* create a zero-padded copy of x */
	for(i = 0; i < ADC_TRIGBUF_SIZE; i++)
		inp[i] = xcpy[i] = x[i];		/* backup x into xcpy, since x may get modified with new ADC values */
	for(i = ADC_TRIGBUF_SIZE; i < 512; i++)
		inp[i] = 0;

	/* calculate FFT and its magnitude */
	arm_rfft_fast_f32(&S_rfft_512, inp, oup, 0);
	arm_cmplx_mag_squared_f32(oup, inp, 256);	/* reuse inp array */

	/* find the dominant frequency (excluding DC) */
	inp[0] = 0;
	arm_max_f32(inp, 256, &maxmag, &maxidx);

	/* there is only DC component */
	if(maxmag == 0){
		return 0;
	}
	/* use chirp-z transform to zoom the FFT and find the exact frequency */
	else{
		/* zoom-in one bin to the left or right */
		if(maxidx == 255){
			f1 = (float32_t)(maxidx - 1)/512.0f;
			f2 = (float32_t)maxidx/512.0f;
		}
		else if(maxidx == 0){
			f1 = (float32_t)maxidx/512.0f;
			f2 = (float32_t)(maxidx + 1)/512.0f;
		}
		else if(inp[maxidx-1] > inp[maxidx+1]){
			f1 = (float32_t)(maxidx - 1)/512.0f;
			f2 = (float32_t)maxidx/512.0f;
		}
		else{
			f1 = (float32_t)maxidx/512.0f;
			f2 = (float32_t)(maxidx + 1)/512.0f;
		}

		czt(xcpy, oup, f1, f2, ADC_TRIGBUF_SIZE, 545, 0);
		arm_max_f32(oup, 545, &maxmag, &maxidx);

		return f1 + maxidx*(f2 - f1)/545.0f;
	}

	return 0;
}

/**
  * @brief  Calculate Vrms of signal.
  * @param  x: input signal
  * @retval calculated duty cycle percentage
  */
static uint8_t calcDuty(__IO uint8_t x[])
{
	uint32_t N, cnt, i;
	float32_t f, temp;

	f = calcFreq(x);
	temp = ceil(1/f);						/* number of sample points in one cycle of the waveform */

	cnt = (float32_t)ADC_TRIGBUF_SIZE/temp;		/* number of integral cycles in the input frame */
	N = round(temp*cnt);					/* number of points for duty cycle calculation */
	if(N > ADC_TRIGBUF_SIZE)
		N = ADC_TRIGBUF_SIZE;

	/* calculate average value of one cycle */
	f = 0;
	for(i = 0; i < N; i++){
		f += x[i];
	}
	f /= N;

	/* count the number of points above the average value */
	cnt = 0;
	for(i = 0; i < N; i++){
		if(x[i] > f)
			cnt++;
	}

	return (float32_t)cnt*100.0f/(float32_t)N;;
}

/**
  * @brief  Calculate Vrms of signal.
  * @param  x: input signal
  * @retval calculated Vrms
  */
static uint8_t calcVrms(__IO uint8_t x[])
{
	uint32_t i;
	float32_t temp, out;

	temp = 0;
	for(i = 0; i < ADC_TRIGBUF_SIZE; i++)
		temp += (float32_t)x[i]*(float32_t)x[i];

	temp /= (float32_t)ADC_TRIGBUF_SIZE;

	arm_sqrt_f32(temp, &out);

	return out;
}

/**
  * @brief  Calculate Vmax of signal.
  * @param  x: input signal
  * @retval calculated Vmax
  */
static uint8_t calcVmax(__IO uint8_t x[])
{
	uint32_t i;
	uint8_t vmax;

	vmax = 0;
	for(i = 0; i < ADC_TRIGBUF_SIZE; i++)
		if(x[i] > vmax)
			vmax = x[i];

	return vmax;
}

/**
  * @brief  Calculate Vmin of signal.
  * @param  x: input signal
  * @retval calculated Vmin
  */
static uint8_t calcVmin(__IO uint8_t x[])
{
	uint32_t i;
	uint8_t vmin;

	vmin = 255;
	for(i = 0; i < ADC_TRIGBUF_SIZE; i++)
		if(x[i] < vmin)
			vmin = x[i];

	return vmin;
}

/**
  * @brief  Calculate Vpp of signal.
  * @param  x: input signal
  * @retval calculated Vpp
  */
static uint8_t calcVpp(__IO uint8_t x[])
{
	uint8_t vmax, vmin;

	vmax = calcVmax(x);
	vmin = calcVmin(x);

	return (vmax - vmin);
}

/**
  * @brief  Calculate Vavg of signal.
  * @param  x: input signal
  * @retval calculated Vavg
  */
static uint8_t calcVavg(__IO uint8_t x[])
{
	uint32_t i, vavg;

	vavg = 0;
	for(i = 0; i < ADC_TRIGBUF_SIZE; i++)
		vavg += x[i];

	vavg /= ADC_TRIGBUF_SIZE;

	return vavg;
}

/* Chirp filter with freq spacing (fs/512)/545, {real, imag, ...}: W^(n*n/2) = exp(j*phi0*n*n/2); phi0 = -2*PI*(1/512)/545 */
static const float32_t chrp545[1090] = {1.000000, 0.000000, 1.000000, -0.000011, 1.000000, -0.000045, 1.000000, -0.000101, 1.000000, -0.000180, 1.000000, -0.000281, 1.000000, -0.000405, 1.000000, -0.000552, 1.000000, -0.000721, 1.000000, -0.000912, 0.999999, -0.001126, 0.999999, -0.001362, 0.999999, -0.001621, 0.999998, -0.001903, 0.999998, -0.002207, 0.999997, -0.002533, 0.999996, -0.002882, 0.999995, -0.003254, 0.999993, -0.003648, 0.999992, -0.004064, 0.999990, -0.004503, 0.999988, -0.004965, 0.999985, -0.005449, 0.999982, -0.005956, 0.999979, -0.006485, 0.999975, -0.007037, 0.999971, -0.007611, 0.999966, -0.008207, 0.999961, -0.008827, 0.999955, -0.009468, 0.999949, -0.010133, 0.999942, -0.010819, 0.999934, -0.011529, 0.999925, -0.012260, 0.999915, -0.013015, 0.999905, -0.013791, 0.999894, -0.014591, 0.999881, -0.015412, 0.999868, -0.016257, 0.999854, -0.017123, 0.999838, -0.018013, 0.999821, -0.018925, 0.999803, -0.019859, 0.999784, -0.020816, 0.999763, -0.021795, 0.999740, -0.022797, 0.999717, -0.023821, 0.999691, -0.024868, 0.999664, -0.025937, 0.999635, -0.027029,
0.999604, -0.028143, 0.999572, -0.029279, 0.999537, -0.030438, 0.999500, -0.031620, 0.999462, -0.032824, 0.999420, -0.034051, 0.999377, -0.035300, 0.999331, -0.036571, 0.999283, -0.037865, 0.999233, -0.039181, 0.999179, -0.040520, 0.999123, -0.041881, 0.999064, -0.043264, 0.999002, -0.044670, 0.998937, -0.046099, 0.998869, -0.047550, 0.998798, -0.049023, 0.998724, -0.050518, 0.998646, -0.052036, 0.998564, -0.053576, 0.998479, -0.055139, 0.998391, -0.056724, 0.998298, -0.058331, 0.998201, -0.059961, 0.998101, -0.061613, 0.997996, -0.063287, 0.997887, -0.064984, 0.997774, -0.066703, 0.997656, -0.068444, 0.997533, -0.070207, 0.997406, -0.071993, 0.997274, -0.073800, 0.997137, -0.075630, 0.996995, -0.077483, 0.996847, -0.079357, 0.996694, -0.081254, 0.996536, -0.083172, 0.996372, -0.085113, 0.996203, -0.087076, 0.996027, -0.089061, 0.995846, -0.091068, 0.995658, -0.093097, 0.995464, -0.095149, 0.995264, -0.097222, 0.995057, -0.099317, 0.994843, -0.101434, 0.994623, -0.103573, 0.994396, -0.105734, 0.994161, -0.107917, 0.993919, -0.110122,
0.993670, -0.112348, 0.993413, -0.114597, 0.993149, -0.116867, 0.992877, -0.119159, 0.992596, -0.121472, 0.992308, -0.123807, 0.992011, -0.126164, 0.991705, -0.128543, 0.991391, -0.130943, 0.991069, -0.133365, 0.990737, -0.135808, 0.990396, -0.138273, 0.990046, -0.140759, 0.989686, -0.143266, 0.989316, -0.145795, 0.988937, -0.148345, 0.988548, -0.150917, 0.988149, -0.153509, 0.987739, -0.156123, 0.987319, -0.158758, 0.986889, -0.161414, 0.986447, -0.164092, 0.985994, -0.166790, 0.985531, -0.169509, 0.985055, -0.172249, 0.984569, -0.175010, 0.984070, -0.177791, 0.983560, -0.180594, 0.983037, -0.183417, 0.982503, -0.186260, 0.981955, -0.189124, 0.981395, -0.192009, 0.980823, -0.194914, 0.980237, -0.197840, 0.979638, -0.200785, 0.979025, -0.203751, 0.978399, -0.206737, 0.977759, -0.209744, 0.977105, -0.212770, 0.976437, -0.215816, 0.975754, -0.218882, 0.975057, -0.221968, 0.974344, -0.225074, 0.973617, -0.228199, 0.972875, -0.231344, 0.972117, -0.234508, 0.971344, -0.237691, 0.970554, -0.240894, 0.969749, -0.244117, 0.968927, -0.247358,
0.968089, -0.250618, 0.967234, -0.253897, 0.966362, -0.257195, 0.965474, -0.260512, 0.964567, -0.263848, 0.963644, -0.267202, 0.962702, -0.270574, 0.961743, -0.273965, 0.960765, -0.277374, 0.959769, -0.280801, 0.958755, -0.284247, 0.957721, -0.287710, 0.956669, -0.291191, 0.955597, -0.294689, 0.954505, -0.298205, 0.953394, -0.301739, 0.952263, -0.305289, 0.951112, -0.308857, 0.949940, -0.312443, 0.948748, -0.316044, 0.947535, -0.319663, 0.946301, -0.323299, 0.945045, -0.326951, 0.943768, -0.330619, 0.942470, -0.334303, 0.941149, -0.338004, 0.939806, -0.341721, 0.938440, -0.345453, 0.937052, -0.349201, 0.935641, -0.352964, 0.934207, -0.356743, 0.932749, -0.360537, 0.931268, -0.364346, 0.929763, -0.368170, 0.928234, -0.372009, 0.926680, -0.375862, 0.925102, -0.379729, 0.923500, -0.383611, 0.921872, -0.387506, 0.920219, -0.391416, 0.918540, -0.395339, 0.916836, -0.399275, 0.915106, -0.403225, 0.913350, -0.407188, 0.911567, -0.411163, 0.909757, -0.415152, 0.907921, -0.419152, 0.906058, -0.423166, 0.904167, -0.427191, 0.902249, -0.431228,
0.900302, -0.435277, 0.898328, -0.439337, 0.896326, -0.443408, 0.894295, -0.447491, 0.892235, -0.451584, 0.890146, -0.455687, 0.888028, -0.459802, 0.885880, -0.463926, 0.883703, -0.468060, 0.881496, -0.472203, 0.879259, -0.476357, 0.876991, -0.480519, 0.874693, -0.484690, 0.872363, -0.488870, 0.870003, -0.493058, 0.867612, -0.497254, 0.865189, -0.501458, 0.862734, -0.505670, 0.860247, -0.509889, 0.857728, -0.514116, 0.855177, -0.518349, 0.852592, -0.522588, 0.849976, -0.526834, 0.847325, -0.531086, 0.844642, -0.535343, 0.841925, -0.539606, 0.839174, -0.543874, 0.836390, -0.548147, 0.833571, -0.552425, 0.830718, -0.556706, 0.827830, -0.560992, 0.824907, -0.565281, 0.821949, -0.569573, 0.818956, -0.573868, 0.815928, -0.578166, 0.812863, -0.582467, 0.809763, -0.586769, 0.806627, -0.591073, 0.803455, -0.595378, 0.800246, -0.599684, 0.797000, -0.603991, 0.793718, -0.608298, 0.790398, -0.612606, 0.787041, -0.616912, 0.783647, -0.621218, 0.780215, -0.625523, 0.776745, -0.629827, 0.773238, -0.634128, 0.769692, -0.638428, 0.766108, -0.642725,
0.762485, -0.647019, 0.758823, -0.651309, 0.755123, -0.655596, 0.751383, -0.659879, 0.747604, -0.664157, 0.743786, -0.668430, 0.739928, -0.672698, 0.736031, -0.676961, 0.732093, -0.681217, 0.728116, -0.685467, 0.724098, -0.689710, 0.720040, -0.693945, 0.715941, -0.698173, 0.711802, -0.702392, 0.707622, -0.706603, 0.703402, -0.710805, 0.699140, -0.714998, 0.694836, -0.719180, 0.690492, -0.723353, 0.686106, -0.727514, 0.681679, -0.731664, 0.677210, -0.735803, 0.672699, -0.739929, 0.668146, -0.744043, 0.663552, -0.748143, 0.658915, -0.752230, 0.654236, -0.756304, 0.649514, -0.760362, 0.644751, -0.764406, 0.639944, -0.768434, 0.635096, -0.772446, 0.630204, -0.776442, 0.625270, -0.780421, 0.620293, -0.784383, 0.615273, -0.788327, 0.610211, -0.792252, 0.605105, -0.796159, 0.599956, -0.800046, 0.594765, -0.803913, 0.589530, -0.807760, 0.584252, -0.811586, 0.578931, -0.815390, 0.573566, -0.819172, 0.568159, -0.822932, 0.562708, -0.826669, 0.557213, -0.830383, 0.551676, -0.834072, 0.546095, -0.837736, 0.540471, -0.841376, 0.534804, -0.844990,
0.529093, -0.848577, 0.523339, -0.852138, 0.517542, -0.855671, 0.511702, -0.859176, 0.505819, -0.862653, 0.499892, -0.866101, 0.493922, -0.869520, 0.487910, -0.872908, 0.481854, -0.876265, 0.475756, -0.879591, 0.469614, -0.882886, 0.463430, -0.886147, 0.457203, -0.889376, 0.450934, -0.892571, 0.444622, -0.895732, 0.438268, -0.898859, 0.431871, -0.901949, 0.425432, -0.905004, 0.418951, -0.908023, 0.412429, -0.911004, 0.405864, -0.913948, 0.399258, -0.916853, 0.392610, -0.919719, 0.385921, -0.922546, 0.379191, -0.925333, 0.372420, -0.928079, 0.365607, -0.930784, 0.358755, -0.933446, 0.351861, -0.936067, 0.344928, -0.938644, 0.337954, -0.941177, 0.330941, -0.943666, 0.323888, -0.946110, 0.316795, -0.948509, 0.309664, -0.950861, 0.302493, -0.953166, 0.295284, -0.955425, 0.288036, -0.957635, 0.280750, -0.959796, 0.273427, -0.961908, 0.266066, -0.963970, 0.258667, -0.965982, 0.251231, -0.967942, 0.243759, -0.969851, 0.236250, -0.971708, 0.228706, -0.973511, 0.221125, -0.975261, 0.213510, -0.976957, 0.205859, -0.978597, 0.198173, -0.980183,
0.190453, -0.981712, 0.182700, -0.983185, 0.174912, -0.984600, 0.167092, -0.985957, 0.159239, -0.987256, 0.151353, -0.988496, 0.143435, -0.989676, 0.135486, -0.990795, 0.127506, -0.991854, 0.119496, -0.992851, 0.111455, -0.993786, 0.103384, -0.994658, 0.095284, -0.995467, 0.087156, -0.996211, 0.078999, -0.996892, 0.070815, -0.997506, 0.062603, -0.998056, 0.054364, -0.998538, 0.046100, -0.998954, 0.037809, -0.999302, 0.029494, -0.999582, 0.021154, -0.999794, 0.012790, -0.999936, 0.004402, -1.000008, -0.004008, -1.000010, -0.012441, -0.999940, -0.020895, -0.999800, -0.029370, -0.999587, -0.037866, -0.999301, -0.046381, -0.998942, -0.054915, -0.998509, -0.063468, -0.998002, -0.072039, -0.997420, -0.080627, -0.996763, -0.089231, -0.996030, -0.097851, -0.995220, -0.106486, -0.994333, -0.115135, -0.993369, -0.123799, -0.992327, -0.132474, -0.991206, -0.141163, -0.990006, -0.149862, -0.988726, -0.158572, -0.987367, -0.167292, -0.985927, -0.176021, -0.984406, -0.184759, -0.982804, -0.193504, -0.981120, -0.202256, -0.979353, -0.211013, -0.977504, -0.219776, -0.975571,
-0.228543, -0.973555, -0.237313, -0.971454, -0.246086, -0.969269, -0.254860, -0.966999, -0.263635, -0.964644, -0.272410, -0.962203, -0.281185, -0.959675, -0.289957, -0.957062, -0.298726, -0.954361, -0.307492, -0.951573, -0.316253, -0.948697, -0.325009, -0.945734, -0.333757, -0.942682, -0.342499, -0.939541, -0.351232, -0.936312, -0.359955, -0.932993, -0.368669, -0.929585, -0.377370, -0.926086, -0.386060, -0.922498, -0.394735, -0.918819, -0.403397, -0.915050, -0.412043, -0.911189, -0.420672, -0.907238, -0.429284, -0.903195, -0.437877, -0.899060, -0.446451, -0.894834, -0.455004, -0.890515, -0.463535, -0.886105, -0.472043, -0.881602, -0.480527, -0.877006, -0.488986, -0.872318, -0.497419, -0.867537, -0.505825, -0.862664, -0.514202, -0.857697, -0.522550, -0.852637, -0.530866, -0.847484, -0.539151, -0.842237, -0.547403, -0.836898, -0.555621, -0.831465, -0.563804, -0.825938, -0.571950, -0.820319, -0.580058, -0.814605, -0.588128, -0.808799, -0.596157, -0.802899, -0.604145, -0.796905, -0.612091, -0.790819, -0.619993, -0.784639, -0.627851, -0.778366, -0.635662, -0.772001, -0.643426, -0.765542,
-0.651141, -0.758990, -0.658807, -0.752346, -0.666421, -0.745610, -0.673984, -0.738781, -0.681493, -0.731861, -0.688947, -0.724848, -0.696345, -0.717744, -0.703686, -0.710548, -0.710968, -0.703262, -0.718191, -0.695884, -0.725353, -0.688417, -0.732452, -0.680858, -0.739487, -0.673211, -0.746458, -0.665473, -0.753363, -0.657646, -0.760200, -0.649731, -0.766969, -0.641727, -0.773667, -0.633636, -0.780294, -0.625457, -0.786849, -0.617191, -0.793330, -0.608838, -0.799736, -0.600399, -0.806065, -0.591875, -0.812316, -0.583266, -0.818489, -0.574572, -0.824581, -0.565794, -0.830592, -0.556933, -0.836519, -0.547990, -0.842363, -0.538964, -0.848121, -0.529857, -0.853793, -0.520669, -0.859376, -0.511402, -0.864870, -0.502054, -0.870274, -0.492629, -0.875585, -0.483125, -0.880804, -0.473544, -0.885928, -0.463887, -0.890957, -0.454155, -0.895888, -0.444347, -0.900722, -0.434466, -0.905456, -0.424512, -0.910089, -0.414486, -0.914621, -0.404389, -0.919049, -0.394221, -0.923373, -0.383985, -0.927591, -0.373680, -0.931703, -0.363307, -0.935706, -0.352869, -0.939601, -0.342365, -0.943384, -0.331797,
-0.947057, -0.321165, -0.950616, -0.310472, -0.954061, -0.299718, -0.957392, -0.288904, -0.960606, -0.278031, -0.963702, -0.267101, -0.966680, -0.256115, -0.969538, -0.245073, -0.972275, -0.233978, -0.974891, -0.222831, -0.977383, -0.211632, -0.979751, -0.200383, -0.981994, -0.189086, -0.984111, -0.177741, -0.986101, -0.166351, -0.987962, -0.154916, -0.989693, -0.143438, -0.991295, -0.131918, -0.992765, -0.120358, -0.994102, -0.108760, -0.995307, -0.097124, -0.996377, -0.085452, -0.997312, -0.073747, -0.998110, -0.062008, -0.998772, -0.050239, -0.999296, -0.038440, -0.999681, -0.026613, -0.999926, -0.014760, -1.000031, -0.002882, -0.999995, 0.009018, -0.999816, 0.020940, -0.999495, 0.032882, -0.999030, 0.044841, -0.998421, 0.056816, -0.997666, 0.068806, -0.996766, 0.080808, -0.995719, 0.092820, -0.994526, 0.104842, -0.993184, 0.116871, -0.991694, 0.128905, -0.990055, 0.140942, -0.988267, 0.152981, -0.986328, 0.165019, -0.984239, 0.177055, -0.981999, 0.189087};

/* Chirp filter with freq spacing (fs/2)/480, {real, imag, ...}: W^(n*n/2) = exp(j*phi0*n*n/2); phi0 = -2*PI*(1/2)/480 */
static const float32_t chrp480[1090] = {1.000000, 0.000000, 0.999995, -0.003272, 0.999914, -0.013090, 0.999566, -0.029448, 0.998630, -0.052336, 0.996655, -0.081721, 0.993069, -0.117537, 0.987172, -0.159666, 0.978148, -0.207912, 0.965074, -0.261979, 0.946931, -0.321440, 0.922623, -0.385705, 0.891008, -0.453991, 0.850927, -0.525287, 0.801255, -0.598326, 0.740953, -0.671560, 0.669132, -0.743147, 0.585136, -0.810939, 0.488623, -0.872499, 0.379659, -0.925130, 0.258820, -0.965930, 0.127282, -0.991871, -0.013090, -0.999919, -0.159667, -0.987176, -0.309019, -0.951062, -0.456907, -0.889522, -0.598329, -0.801259, -0.727628, -0.685982, -0.838677, -0.544643, -0.925135, -0.379661, -0.980794, -0.195092, -1.000004, 0.003272, -0.978158, 0.207914, -0.912220, 0.409728, -0.801263, 0.598332, -0.646964, 0.762537, -0.453997, 0.891018, -0.230265, 0.973142, 0.013090, 0.999929, 0.261983, 0.965089, 0.500008, 0.866040, 0.709429, 0.704801, 0.872512, 0.488630, 0.973147, 0.230267, 0.998649, -0.052337, 0.941563, -0.336897, 0.801271, -0.598337, 0.585148, -0.810954, 0.309024, -0.951079, -0.003272, -1.000019,
-0.321447, -0.946954, -0.611370, -0.791378, -0.838693, -0.544654, -0.973156, -0.230269, -0.993098, 0.117541, -0.889544, 0.456918, -0.669152, 0.743168, -0.355323, 0.934779, 0.013090, 0.999948, 0.385718, 0.922655, 0.707132, 0.707133, 0.925162, 0.379673, 0.999953, -0.013090, 0.912246, -0.409740, 0.669159, -0.743175, 0.305917, -0.952103, -0.117542, -0.993112, -0.525309, -0.850965, -0.838710, -0.544665, -0.991914, -0.127288, -0.946977, 0.321455, -0.704825, 0.709453, -0.309034, 0.951106, 0.159674, 0.987225, 0.598357, 0.801299, 0.904041, 0.427580, 0.998688, -0.052338, 0.850977, -0.525317, 0.488652, -0.872549, -0.003272, -1.000058, -0.500032, -0.866082, -0.867714, -0.497197, -0.999982, 0.013090, -0.850986, 0.525322, -0.454024, 0.891070, 0.081726, 0.996728, 0.598369, 0.801314, 0.934820, 0.355339, 0.978225, -0.207927, 0.704846, -0.709473, 0.195107, -0.980866, -0.385736, -0.922700, -0.838742, -0.544687, -0.999654, 0.029450, -0.801326, 0.598377, -0.305932, 0.952149, 0.309045, 0.951146, 0.811013, 0.585191, 1.000012, -0.013090, 0.791436, -0.611414,
0.258846, -0.966023, -0.385743, -0.922718, -0.872587, -0.488674, -0.987277, 0.159682, -0.669205, 0.743225, -0.049075, 0.998907, 0.598392, 0.801346, 0.973241, 0.230290, 0.891113, -0.454043, 0.379705, -0.925238, -0.321477, -0.947047, -0.867765, -0.497227, -0.978272, 0.207937, -0.585212, 0.811040, 0.117551, 0.993199, 0.762628, 0.647044, 0.998766, -0.052341, 0.686074, -0.727723, -0.013090, -1.000055, -0.709518, -0.704891, -1.000146, -0.000002, -0.704895, 0.709521, 0.013090, 1.000065, 0.727733, 0.686084, 0.998785, -0.052342, 0.647060, -0.762647, -0.117554, -0.993228, -0.811068, -0.585232, -0.978310, 0.207944, -0.497249, 0.867802, 0.321492, 0.947093, 0.925287, 0.379726, 0.891165, -0.454069, 0.230306, -0.973303, -0.598432, -0.801401, -0.998980, -0.049079, -0.669258, 0.743283, 0.159694, 0.987359, 0.872663, 0.488718, 0.922804, -0.385778, 0.258873, -0.966117, -0.611476, -0.791518, -1.000119, 0.013090, -0.585258, 0.811103, 0.309079, 0.951257, 0.952265, 0.305971, 0.801429, -0.598452, -0.029452, -0.999785, -0.838855, -0.544762, -0.922831, 0.385789,
-0.195138, 0.981008, 0.709579, 0.704954, 0.978377, -0.207957, 0.355398, -0.934969, -0.598466, -0.801448, -0.996898, 0.081738, -0.454105, 0.891225, 0.525415, 0.851140, 1.000167, -0.013090, 0.497293, -0.867878, -0.500127, -0.866252, -1.000257, 0.003270, -0.488754, 0.872726, 0.525425, 0.851157, 0.998902, -0.052347, 0.427676, -0.904237, -0.598489, -0.801480, -0.987451, 0.159707, -0.309109, 0.951327, 0.709620, 0.704996, 0.947209, -0.321530, 0.127322, -0.992160, -0.838920, -0.544806, -0.851186, 0.525442, 0.117570, 0.993374, 0.952357, 0.306002, 0.669344, -0.743375, -0.409850, -0.912501, -1.000235, 0.013090, -0.379785, 0.925426, 0.707336, 0.707342, 0.922930, -0.385829, -0.013090, -1.000250, -0.935064, -0.355435, -0.669363, 0.743397, 0.457058, 0.889827, 0.993417, -0.117574, 0.230348, -0.973473, -0.838969, -0.544838, -0.791646, 0.611572, 0.321553, 0.947278, 1.000364, -0.003269, 0.309137, -0.951410, -0.811240, -0.585359, -0.801562, 0.598549, 0.337015, 0.941909, 0.999019, -0.052351, 0.230357, -0.973510, -0.872840, -0.488820, -0.705075, 0.709698,
0.500198, 0.866379, 0.965470, -0.262081, -0.013090, -1.000328, -0.973534, -0.230363, -0.454187, 0.891380, 0.762849, 0.647236, 0.801602, -0.598578, -0.409897, -0.912608, -0.978578, 0.207997, 0.003268, 1.000437, 0.981223, 0.195183, 0.379835, -0.925542, -0.839050, -0.544892, -0.686297, 0.727954, 0.598598, 0.801629, 0.889936, -0.457113, -0.309157, -0.951508, -0.987643, 0.159736, 0.013090, 1.000396, 0.992348, 0.127349, 0.258952, -0.966398, -0.925583, -0.379852, -0.488871, 0.872929, 0.811341, 0.585435, 0.669476, -0.743519, -0.671899, -0.741336, -0.801673, 0.598629, 0.525555, 0.851374, 0.891479, -0.454224, -0.385904, -0.923115, -0.947440, 0.321605, 0.262114, 0.965597, 0.978683, -0.208018, -0.159747, -0.987715, -0.993620, 0.117596, 0.081760, 0.997214, 0.999194, -0.052358, -0.029458, -1.000136, -1.000489, 0.013090, 0.003267, 1.000574, 1.000584, 0.000007, -0.003267, -1.000583, -1.000508, 0.013090, 0.029458, 1.000165, 0.999233, -0.052360, -0.081763, -0.997262, -0.993679, 0.117602, 0.159757, 0.987783, 0.978759, -0.208034, -0.262136, -0.965682,
-0.947533, 0.321636, 0.385944, 0.923215, 0.891584, -0.454276, -0.525620, -0.851482, -0.801783, 0.598709, 0.671995, 0.741445, 0.669581, -0.743633, -0.811474, -0.585533, -0.488958, 0.873081, 0.925753, 0.379924, 0.259005, -0.966586, -0.992551, -0.127378, 0.013090, 1.000610, 0.987865, -0.159769, -0.309227, -0.951731, -0.890153, 0.457221, 0.598747, 0.801834, 0.686479, -0.728143, -0.839276, -0.545043, -0.379945, 0.925802, 0.981508, 0.195244, -0.003266, -1.000739, -0.978883, 0.208058, 0.410025, 0.912903, 0.801869, -0.598772, -0.763106, -0.647460, -0.454350, 0.891690, 0.973883, 0.230451, -0.013090, -1.000698, -0.965838, 0.262176, 0.500389, 0.866719, 0.705360, -0.709978, -0.873194, -0.489024, -0.230459, 0.973916, 0.999447, -0.052368, -0.337158, -0.942323, -0.801924, 0.598812, 0.811607, 0.585632, 0.309287, -0.951853, -1.000841, 0.003265, 0.321703, 0.947741, 0.792043, -0.611871, -0.839390, -0.545119, -0.230473, 0.973973, 0.993940, -0.117629, -0.457297, -0.890306, -0.669733, 0.743797, 0.935580, 0.355639, -0.013090, -1.000815, -0.923463, 0.386044,
0.707744, 0.707760, 0.380017, -0.925972, -1.000839, 0.013090, 0.410095, 0.913063, 0.669766, -0.743833, -0.952957, -0.306203, 0.117637, 0.994013, 0.851745, -0.525778, -0.839471, -0.545173, -0.127416, 0.992825, 0.947857, -0.321741, -0.710104, -0.705489, -0.309334, 0.951991, 0.988154, -0.159812, -0.598913, -0.802062, -0.427997, 0.904893, 0.999641, -0.052376, -0.525810, -0.851799, -0.489133, 0.873384, 1.001026, -0.003263, -0.500508, -0.866931, -0.497694, 0.868557, 1.000966, -0.013090, -0.525830, -0.851833, -0.454486, 0.891949, 0.997724, -0.081795, -0.598958, -0.802125, -0.355709, 0.935757, 0.979217, -0.208125, -0.710186, -0.705572, -0.195319, 0.981866, 0.923653, -0.386120, -0.839600, -0.545259, 0.029467, 1.000691, 0.802169, -0.598990, -0.953142, -0.306265, 0.309357, 0.952150, 0.585820, -0.811862, -1.001073, 0.013090, 0.612055, 0.792288, 0.259137, -0.967054, -0.923716, 0.386146, 0.873523, 0.489214, -0.159841, -0.988351, -0.669945, 0.744026, 1.000000, 0.049142, -0.599039, -0.802236, -0.230558, 0.974313, 0.892108, -0.454534, -0.926264, -0.380141,
0.321824, 0.948111, 0.497798, -0.868733, -0.979380, 0.208157, 0.811952, 0.585887, -0.117671, -0.994332, -0.647795, 0.763491, 0.999914, -0.052387, -0.728552, -0.686875, 0.013090, 1.001214, 0.705722, -0.710333, -1.001314, -0.000017, 0.710343, 0.705732, -0.013090, -1.001243, -0.686906, 0.728584, 0.999972, -0.052389, -0.763546, -0.647843, 0.117680, 0.994419, 0.585948, -0.812034, -0.979494, 0.208180, 0.868846, 0.497865, -0.321869, -0.948250, -0.380204, 0.926412, 0.892265, -0.454612, -0.974498, -0.230604, 0.599159, 0.802401, 0.049156, -1.000219, -0.670103, 0.744198, 0.988597, -0.159878, -0.873751, -0.489345, 0.386250, 0.923973, 0.259216, -0.967336, -0.792533, 0.612240, 1.001394, -0.013090, -0.812132, -0.586020, 0.309461, 0.952484, 0.306381, -0.953488, -0.802476, 0.599213, 1.001085, -0.029474, -0.839941, -0.545487, 0.386279, 0.924046, 0.195410, -0.982294, -0.705896, 0.710503, 0.979676, -0.208217, -0.936205, -0.355886, 0.599251, 0.802527, -0.081831, -0.998234, -0.454730, 0.892414, 0.852296, -0.526109, -1.001521, 0.013090, 0.869048, 0.497984,
-0.500794, -0.867441, 0.003257, 1.001626, 0.489440, -0.873916, -0.852338, 0.526134, 1.000284, -0.052402, -0.905484, -0.428285, 0.599308, 0.802606, -0.159913, -0.988833, -0.309559, 0.952656, 0.706000, -0.710606, -0.948551, 0.321967, 0.993563, 0.127520, -0.840103, -0.545595, 0.526176, 0.852409, -0.117720, -0.994797, -0.306458, 0.953719, 0.670321, -0.744434, -0.913827, 0.410426, 1.001687, -0.013091, -0.926766, -0.380355, 0.708356, 0.708388, -0.386377, -0.924290, 0.013091, 1.001721, 0.355977, -0.936436, -0.670368, 0.744485, 0.891156, -0.457720, -0.994899, 0.117731, 0.974923, 0.230711, -0.840216, -0.545671, 0.612477, 0.792849, -0.322020, -0.948714, 0.003255, 1.001879, 0.309625, -0.952849, -0.586267, 0.812464, 0.802799, -0.599448, -0.943359, 0.337514, 1.000556, -0.052413, -0.975008, -0.230732, 0.874182, 0.489593, -0.710786, -0.706184, 0.500961, 0.867738, -0.262471, -0.966984, 0.013091, 1.001896, 0.230745, -0.975060, -0.454921, 0.892777, 0.648275, -0.764043, -0.802886, 0.599512, 0.914069, -0.410531, -0.980144, 0.208310, 1.002040, -0.003253,
-0.982795, -0.195516, 0.927026, 0.380465, -0.840394, -0.545790, 0.729120, 0.687424, -0.599555, -0.802945, 0.457840, 0.891396, -0.309644, -0.953071, 0.159978, 0.989267, -0.013091, -1.002042, -0.127580, 0.993983, 0.259401, -0.967992, -0.380502, 0.927111, 0.489703, -0.874372, -0.586429, 0.812684, 0.670612, -0.744750, -0.742595, 0.673012, 0.803036, -0.599621, -0.852823, 0.526425, 0.892999, -0.454974, -0.924692, 0.386540, 0.949061, -0.322133, -0.967253, 0.262541, 0.980364, -0.208354, -0.989416, 0.160000, 0.995335, -0.117777, -0.998939, 0.081879, 1.000927, -0.052427, -1.001874, 0.029487, 1.002233, -0.013091, -1.002322, 0.003251, 1.002337, 0.000029, -1.002342, 0.003251, 1.002272, -0.013091, -1.001933, 0.029488, 1.001004, -0.052430, -0.999036, 0.081886, 0.995452, -0.117789, -0.989551, 0.160020, 0.980517, -0.208384, -0.967423, 0.262585, 0.949247, -0.322193, -0.924891, 0.386620, 0.893209, -0.455078, -0.853040, 0.526555, 0.803256, -0.599781, -0.742814, 0.673205, 0.670824, -0.744979, -0.586627, 0.812950, 0.489878, -0.874676, -0.380647, 0.927452,
0.259506, -0.968368, -0.127637, 0.994389, -0.013091, -1.002471, 0.160044, 0.989711, -0.309783, -0.953518, 0.458057, 0.891833, -0.599853, -0.803355, 0.729498, 0.687790, -0.840849, -0.546093, 0.927546, 0.380687, -0.983367, -0.195638, 1.002644, -0.003248, -0.980756, 0.208432, 0.914659, -0.410787, -0.803422, 0.599902, 0.648723, -0.764557, -0.455247, 0.893398, 0.230920, -0.975760, 0.013091, 1.002637, -0.262662, -0.967721, 0.501342, 0.868419, -0.711347, -0.706755, 0.874892, 0.490003, -0.975822, -0.230935, 1.001414, -0.052447, -0.944189, 0.337799, 0.803525, -0.599976, -0.586812, 0.813201, 0.309925, -0.953736, 0.003246, 1.002835, -0.322322, -0.949641, 0.613075, 0.793643, -0.841060, -0.546234, 0.975926, 0.230961, -0.995947, 0.117841, 0.892117, -0.458199, -0.671109, 0.745287, 0.356385, -0.937471, 0.013091, 1.002852, -0.386808, -0.925357, 0.709173, 0.709226, -0.927861, -0.380820, 1.002896, -0.013091, -0.914955, 0.410916, 0.671168, -0.745351};

/* 1024-point FFT of the chrp545 filter */
static const float32_t fftchrp545[2048] = {425.191405, 518.436388, 444.330560, -192.930643, -183.843216, -121.923308, 54.527220, 87.856784, -24.519061, -52.795883, 16.790272, 34.722570, -14.313638, -24.593396, 13.356994, 18.083259, -12.876661, -13.401535, 12.503732, 9.751057, -12.085407, -6.748496, 11.554371, 4.199803, -10.883713, -2.004440, 10.068652, 0.110492, -9.118012, 1.508185, 8.049616, -2.864442, -6.887420, 3.965029, 5.659458, -4.814919, -4.396205, 5.419947, 3.129188, -5.788394, -1.889733, 5.931871, 0.707859, -5.865707, 0.388714, 5.608964, -1.375412, -5.184186, 2.231531, 4.616922, -2.940801, -3.935092, 3.491770, 3.168240, -3.878043, -2.346716, 4.098343, 1.500818, -4.156398, -0.659940, 4.060679, -0.148249, -3.823981, 0.898560, 3.462893, -1.568954, -2.997138, 2.141092, 2.448845, -2.600768, -1.841763, 2.938193, 1.200425, -3.148132, -0.549344, 3.229894, -0.087810, -3.187176, 0.688932, 3.027766, -1.234178, -2.763122, 1.706530, 2.407846, -2.092272, -1.979067, 2.381323, 1.495761, -2.567446, -0.978029, 2.648328, 0.446357, -2.625504, 0.079104, 2.504166, -0.579237, -2.292854, 1.036588, 2.003022, -1.435924,
-1.648542, 1.764696, 1.245122, -2.013389, -0.809676, 2.175762, 0.359682, -2.248960, 0.087467, 2.233501, -0.515087, -2.133151, 0.907791, 1.954676, -1.252000, -1.707504, 1.536382, 1.403298, -1.752201, -1.055458, 1.893548, 0.678574, -1.957483, -0.287860, 1.944046, -0.101428, -1.856170, 0.474557, 1.699494, -0.817844, -1.482064, 1.119134, 1.213980, -1.368207, -0.906949, 1.557104, 0.573822, -1.680364, -0.228065, 1.735152, -0.116748, -1.721301, 0.447452, 1.641247, -0.751768, -1.499867, 1.018748, 1.304229, -1.239147, -1.063282, 1.405728, 0.787460, -1.513487, -0.488257, 1.559786, 0.177767, -1.544392, 0.131786, 1.469431, -0.428515, -1.339253, 0.701311, 1.160207, -0.940247, -0.940366, 1.136923, 0.689171, -1.284754, -0.417042, 1.379175, 0.134970, -1.417773, 0.145927, 1.400329, -0.414821, -1.328776, 0.661587, 1.207084, -0.877166, -1.041061, 1.053893, 0.838093, -1.185766, -0.606828, 1.268627, 0.356820, -1.300296, -0.098148, 1.280607, -0.158984, -1.211377, 0.404642, 1.096297, -0.629530, -0.940749, 0.825343, 0.751574, -0.985060, -0.536775, 1.103189,
0.305192, -1.175951, -0.066140, 1.201392, -0.170949, -1.179424, 0.396896, 1.111794, -0.603128, -1.001981, 0.781986, 0.855036, -0.927014, -0.677351, 1.033181, 0.476394, -1.097051, -0.260403, 1.116885, 0.038053, -1.092686, 0.181886, 1.026161, -0.390891, -0.920629, 0.581007, 0.780868, -0.745149, -0.612903, 0.877358, 0.423752, -0.973014, -0.221142, 1.028994, 0.013196, -1.043765, 0.191889, 1.017421, -0.386156, -0.951653, 0.562201, 0.849657, -0.713436, -0.715986, 0.834349, 0.556356, -0.920691, -0.377403, 0.969622, 0.186412, -0.979801, 0.008974, 0.951419, -0.201054, -0.886161, 0.382374, 0.787128, -0.546008, -0.658686, 0.685822, 0.506288, -0.796699, -0.336237, 0.874723, 0.155439, -0.917314, 0.028884, 0.923313, -0.209474, -0.893002, 0.379316, 0.828076, -0.531915, -0.731555, 0.661539, 0.607652, -0.763429, -0.461592, 0.833971, 0.299391, -0.870828, -0.127615, 0.873003, -0.046881, -0.840874, 0.217230, 0.776147, -0.376816, -0.681783, 0.519530, 0.561860, -0.639997, -0.421404, 0.733784, 0.266181, -0.797557, -0.102458, 0.829195, -0.063243, -0.827860,
0.224402, 0.794018, -0.374759, -0.729392, 0.508551, 0.636895, -0.620735, -0.520491, 0.707174, 0.385033, -0.764785, -0.236060, 0.791651, 0.079575, -0.787081, 0.078197, 0.751623, -0.231051, -0.687027, 0.373049, 0.596161, -0.498745, -0.482893, 0.603393, 0.351921, -0.683128, -0.208584, 0.735101, 0.058647, -0.757582, 0.091931, 0.750018, -0.237236, -0.713039, 0.371621, 0.648415, -0.489925, -0.558986, 0.587680, 0.448533, -0.661270, -0.321616, 0.708058, 0.183394, -0.726493, -0.039415, 0.716148, -0.104605, -0.677731, 0.243008, 0.613039, -0.370419, -0.524885, 0.481943, 0.416972, -0.573362, -0.293741, 0.641288, 0.160185, -0.683289, -0.021659, 0.697975, -0.116346, -0.685039, 0.248411, 0.645261, -0.369403, -0.580469, 0.474678, 0.493453, -0.560246, -0.387849, 0.622933, 0.267986, -0.660494, -0.138711, 0.671692, 0.005197, -0.656332, 0.127266, 0.615267, -0.253482, -0.550352, 0.368544, 0.464357, -0.468030, -0.360861, 0.548173, 0.244091, -0.605994, -0.118761, 0.639422, -0.010125, -0.647362, 0.137462, 0.629729, -0.258256, -0.587443, 0.367812, 0.522385,
-0.461921, -0.437314, 0.537011, 0.335751, -0.590295, -0.221836, 0.619861, 0.100154, -0.624750, 0.024437, 0.604979, -0.147011, -0.561531, 0.262761, 0.496318, -0.367189, -0.412084, 0.456278, 0.312304, -0.526650, -0.201033, 0.575688, 0.082743, -0.601635, 0.037852, 0.603656, -0.155984, -0.581867, 0.267024, 0.537315, -0.366657, -0.471934, 0.451047, 0.388464, -0.516995, -0.290334, 0.562047, 0.181521, -0.584589, -0.066394, 0.583909, -0.050466, -0.560211, 0.164443, 0.514604, -0.271068, -0.449048, 0.366201, 0.366277, -0.446179, -0.269680, 0.507967, 0.163163, -0.549265, -0.050996, 0.568596, -0.062363, -0.565361, 0.172436, 0.539853, -0.274913, -0.493238, 0.365813, 0.427502, -0.441633, -0.345375, 0.499495, 0.250206, -0.537248, -0.145838, 0.553542, 0.036449, -0.547887, 0.073615, 0.520660, -0.180013, -0.473077, 0.278579, 0.407158, -0.365481, -0.325622, 0.437372, 0.231791, -0.491522, -0.129445, 0.525917, 0.022673, -0.539332, 0.084285, 0.531378, -0.187212, -0.502510, 0.282079, 0.454001, -0.365198, -0.387894, 0.433367, 0.306908, -0.483997, -0.214332,
0.515204, 0.113890, -0.525879, -0.009590, 0.515736, -0.094429, -0.485301, 0.194069, 0.435903, -0.285429, -0.369606, 0.364958, 0.289130, -0.429591, -0.197736, 0.476872, 0.099092, -0.505045, 0.002865, 0.513112, -0.104099, -0.500877, 0.200616, 0.468942, -0.288642, -0.418687, 0.364755, 0.352201, -0.426020, -0.272201, 0.470112, 0.181921, -0.495390, -0.084983, 0.500963, -0.014752, -0.486727, 0.113333, 0.453356, -0.206880, -0.402275, 0.291729, 0.335597, -0.364583, -0.256041, 0.422637, 0.166819, -0.463681, -0.071499, 0.486189, -0.026119, -0.489376, 0.122174, 0.473222, -0.212886, -0.438469, 0.294702, 0.386590, -0.364443, -0.319722, 0.419421, 0.240582, -0.457545, -0.152360, 0.477402, 0.058585, -0.478298, 0.037015, 0.460303, -0.130657, -0.424220, 0.218656, 0.371567, -0.297568, -0.304509, 0.364327, 0.225760, -0.416358, -0.138493, 0.451683, 0.046190, -0.468990, 0.047479, 0.467687, -0.138809, -0.447918, 0.224209, 0.410552, -0.300338, -0.357151, 0.364234, 0.289901, -0.413433, -0.211523, 0.446066, 0.125163, -0.460923, -0.034269, 0.457500, -0.057549,
-0.436021, 0.146663, 0.397415, -0.229568, -0.343287, 0.303019, 0.275847, -0.364161, -0.197817, 0.410635, 0.112326, -0.440674, -0.022783, 0.453167, -0.067259, -0.447701, 0.154241, 0.424568, -0.234744, -0.384763, 0.305617, 0.329930, -0.364106, -0.262301, 0.407952, 0.184600, -0.435489, -0.099940, 0.445700, 0.011695, -0.438256, 0.076637, 0.413524, -0.161566, -0.372555, 0.239754, 0.317035, -0.308141, -0.249217, 0.364066, 0.171829, -0.405374, -0.087967, 0.430492, 0.000971, -0.438495, 0.085712, 0.429136, -0.168661, -0.402854, 0.244613, 0.360756, -0.310596, -0.304566, 0.364043, 0.236559, -0.402892, -0.159469, 0.425669, 0.076375, -0.431531, 0.009418, 0.420315, -0.094510, -0.392528, 0.175542, 0.349329, -0.249330, -0.292487, 0.312985, 0.224293, -0.364032, -0.147485, 0.400500, 0.065130, -0.421002, 0.019499, 0.424788, -0.103051, -0.411767, 0.182229, 0.382515, -0.253919, -0.338247, 0.315317, 0.280765, -0.364034, -0.212384, 0.398188, 0.135846, -0.416482, -0.054205, 0.418248, -0.029299, -0.403470, 0.111358, 0.372793, -0.188735, -0.327480, 0.258390,
0.269371, -0.317595, -0.200805, 0.364046, 0.124527, -0.395950, -0.043574, 0.412095, -0.038838, -0.411894, 0.119449, 0.395405, -0.195077, -0.363336, 0.262752, 0.317003, -0.319823, -0.258280, 0.364071, 0.189529, -0.393781, -0.113498, 0.407831, 0.033213, -0.405711, 0.048139, 0.387552, -0.127341, -0.354123, 0.201268, 0.306792, -0.267014, -0.247467, 0.322007, 0.178531, -0.364103, -0.102736, 0.391676, 0.023099, -0.403680, 0.057224, 0.399685, -0.135053, -0.379895, 0.207321, 0.345135, -0.271186, -0.296824, 0.324149, 0.236908, -0.364144, -0.167788, 0.389627, 0.092221, -0.399632, -0.013212, 0.393803, -0.066106, -0.372413, 0.142597, 0.336351, -0.213245, -0.287080, 0.275274, 0.226582, -0.326253, -0.157278, 0.364194, 0.081931, -0.387632, -0.003535, 0.395680, -0.074805, -0.388055, 0.149989, 0.365097, -0.219054, -0.327756, 0.279285, 0.277541, -0.328321, -0.216469, 0.364252, 0.146981, -0.385688, -0.071846, 0.391813, -0.005954, -0.382427, 0.083337, 0.357931, -0.157243, -0.319333, 0.224757, 0.268191, -0.283227, -0.206553, 0.330361, 0.136881, -0.364317,
-0.061949, 0.383785, -0.015270, -0.388028, 0.091716, 0.376909, -0.164370, -0.350902, 0.230364, 0.311068, -0.287106, -0.259010, 0.332370, 0.196812, -0.364389, -0.126958, 0.381926, 0.052222, -0.384315, 0.024427, 0.371492, -0.099956, -0.343998, 0.171380, 0.302945, -0.235883, -0.249986, 0.290928, 0.187236, -0.334355, -0.117197, 0.364468, 0.042653, -0.380102, 0.033441, 0.380668, -0.108071, -0.366170, 0.178288, 0.337207, -0.241324, -0.294953, 0.294699, 0.241102, -0.336318, -0.177805, 0.364553, 0.107582, -0.378315, -0.033223, 0.377082, -0.042325, -0.360929, 0.116071, 0.330519, -0.185102, -0.287077, 0.246694, 0.232346, -0.298423, -0.168507, 0.338259, 0.098099, -0.364645, -0.023919, 0.376559, -0.051093, -0.373551, 0.123971, 0.355764, -0.191832, -0.323923, 0.252000, 0.279309, -0.302107, -0.223704, 0.340184, 0.159327, -0.364744, -0.088734, 0.374832, 0.014727, -0.370069, 0.059759, 0.350667, -0.131779, -0.317410, 0.198487, 0.271633, -0.257251, -0.215165, 0.305755, 0.150252, -0.342096, -0.079473, 0.364848, 0.005636, -0.373130, 0.068333, 0.366633,
-0.139509, -0.345630, 0.205078, 0.310971, -0.262454, -0.264042, 0.309372, 0.206714, -0.343993, -0.141268, 0.364957, 0.070304, -0.371452, 0.003368, 0.363234, -0.076829, -0.340647, 0.147170, 0.304595, -0.211613, -0.256523, 0.267613, 0.198344, -0.312965, -0.132367, 0.345882, 0.061213, -0.365074, 0.012299, 0.369795, -0.085254, -0.359872, 0.154771, 0.335710, -0.218100, -0.298278, 0.272740, 0.249069, -0.316534, -0.190040, 0.347762, 0.123535, -0.365196, -0.052191, 0.368157, -0.021163, -0.356540, 0.093623, 0.330812, -0.162323, -0.292007, 0.224546, 0.241668, -0.277835, -0.181792, 0.320088, 0.114759, -0.349636, -0.043225, 0.365322, -0.029975, -0.366534, 0.101946, 0.353232, -0.169835, -0.325950, 0.230962, 0.285776, -0.282910, -0.234309, 0.323628, 0.173591, -0.351509, -0.106030, 0.365457, 0.034304, -0.364927, 0.038747, 0.349946, -0.110230, -0.321115, 0.177317, 0.279577, -0.237355, -0.226987, 0.287968, 0.165427, -0.327159, -0.097337, 0.353380, 0.025417, -0.365596, 0.047487, 0.363331, -0.118489, -0.346678, 0.184776, 0.316301, -0.243730, -0.273404,
0.293017, 0.219690, -0.330685, -0.157288, 0.355252, 0.088669, -0.365741, -0.016552, 0.361747, -0.056208, -0.343424, 0.126730, 0.311503, -0.192225, -0.267246, 0.250099, 0.212411, -0.298061, -0.149165, 0.334213, 0.080017, -0.357127, -0.007701, 0.365895, -0.064919, -0.360170, 0.134966, 0.340179, -0.199668, -0.306713, 0.256467, 0.261098, -0.303106, -0.205139, 0.337746, 0.141050, -0.359008, -0.071367, 0.366054, -0.001151, -0.358599, 0.073631, 0.336941, -0.143206, -0.301929, 0.207119, 0.254953, -0.262841, -0.197866, 0.308162, 0.132930, -0.341286, -0.062712, 0.360898, -0.010010, -0.366218, 0.082354, 0.357033, -0.151458, -0.333702, 0.214584, 0.297143, -0.269231, -0.248801, 0.313231, 0.190585, -0.344840, -0.124798, 0.362797, 0.054039, -0.366391, 0.018889, 0.355471, -0.091100, -0.330462, 0.159735, 0.292350, -0.222073, -0.242636, 0.275644, 0.183286, -0.318321, -0.116641, 0.348409, 0.045340, -0.364710, 0.027799, 0.366571, -0.099878, -0.353907, 0.168045, 0.327215, -0.229594, -0.287543, 0.282087, 0.236453, -0.323437, -0.175959, 0.352001, 0.108452,
-0.366638, -0.036602, 0.366756, -0.036749, -0.352344, 0.108699, 0.323960, -0.176397, -0.282718, 0.237158, 0.230240, -0.288569, -0.168595, 0.328587, 0.100220, -0.355619, -0.027816, 0.368582, -0.045753, -0.366951, 0.117578, 0.350778, -0.184806, -0.320690, 0.244773, 0.277867, -0.295097, -0.223992, 0.333778, 0.161188, -0.359269, -0.091935, 0.370547, 0.018970, -0.367155, 0.054822, 0.349208, -0.126520, -0.317404, 0.193279, 0.272985, -0.252449, -0.217701, 0.301681, 0.153725, -0.339014, -0.083586, 0.362954, 0.010052, -0.372536, 0.063965, 0.367366, -0.135539, -0.347630, 0.201827, 0.314093, -0.260198, -0.268067, 0.308330, 0.211357, -0.344305, -0.146198, 0.366679, 0.075161, -0.374550, -0.001051, 0.367587, -0.073199, -0.346044, 0.144649, 0.310756, -0.210464, -0.263103, 0.268029, 0.204954, -0.315052, -0.138597, 0.349656, 0.066650, -0.370451, 0.008044, 0.376592, -0.082531, -0.367816, 0.153861, 0.344447, -0.219201, -0.307389, 0.275953, 0.258089, -0.321857, -0.198481, 0.355076, 0.130911, -0.374274, -0.058042, 0.378666, -0.017248, -0.368056, 0.091978,
0.342838, -0.163187, -0.303987, 0.228049, 0.253017, -0.283981, -0.191931, 0.328753, 0.123129, -0.360572, -0.049322, 0.378154, -0.026573, -0.380775, 0.101552, 0.368306, -0.172643, -0.341213, 0.237023, 0.300544, -0.292127, -0.247883, 0.335754, 0.185294, -0.366154, -0.115238, 0.382097, 0.040478, -0.382924, 0.036033, 0.368569, -0.111267, -0.339574, 0.182241, 0.297057, -0.246134, -0.242675, 0.300399, 0.178560, -0.342867, -0.107232, 0.371830, 0.031499, -0.386110, 0.045641, 0.385113, -0.121140, -0.368844, 0.191999, 0.337915, -0.255400, -0.293520, 0.308816, 0.237389, -0.350106, -0.171718, 0.377609, 0.099090, -0.390200, -0.022369, 0.387347, -0.055416, -0.369132, 0.131186, 0.336233, -0.201931, -0.289927, 0.264835, 0.232012, -0.317388, -0.164758, 0.357483, 0.090807, -0.383500, -0.013073, 0.394373, -0.065372, -0.389636, 0.141419, 0.369434, -0.212052, -0.334530, 0.274454, 0.286272, -0.326133, -0.226539, 0.365011, 0.157667, -0.389516, -0.082362, 0.398639, 0.003593, -0.391976, 0.075527, 0.369750, -0.151864, -0.332801, 0.222384, 0.282552, -0.284276,
-0.220959, 0.335065, 0.150433, -0.372705, -0.073744, 0.395669, -0.006086, -0.403004, 0.085900, 0.394376, -0.162534, -0.370083, 0.232945, 0.331041, -0.294320, -0.278757, 0.344201, 0.215262, -0.380576, -0.143043, 0.401967, 0.064935, -0.407477, 0.015982, 0.396840, -0.096510, -0.370433, 0.173455, 0.329251, -0.243755, -0.274879, 0.304604, 0.209439, -0.353561, -0.135483, 0.388647, 0.055919, -0.408427, 0.026116, 0.412069, -0.107378, -0.399378, 0.184644, 0.370803, -0.254837, -0.327425, 0.315152, 0.270917, -0.363164, -0.203475, 0.396929, 0.127736, -0.415062, -0.046676, 0.416791, -0.036509, -0.401990, 0.118530, 0.371193, -0.196129, -0.325562, 0.266216, 0.266857, -0.325986, -0.197360, 0.373033, 0.119788, -0.405445, -0.037186, 0.421888, -0.047184, -0.421652, 0.129988, 0.404687, -0.207935, -0.371605, 0.277918, 0.323657, -0.337130, -0.262693, 0.383187, 0.191080, -0.414214, -0.111619, 0.428922, 0.027429, -0.426667, 0.058167, 0.407475, -0.141781, -0.372040, 0.220091, 0.321709, -0.289970, -0.258415, 0.348616, 0.184620, -0.393659, -0.103209, 0.423259,
0.017379, -0.436182, 0.069483, 0.431848, -0.153938, -0.410361, 0.232628, 0.372504, -0.302406, -0.319711, 0.360471, 0.254013, -0.404471, -0.177965, 0.432604, 0.094538, -0.443688, -0.007010, 0.437211, -0.081165, -0.413356, 0.166493, 0.372996, -0.245578, -0.317659, 0.315258, 0.249477, -0.372729, -0.171098, 0.415657, 0.085582, -0.442277, 0.003706, 0.451463, -0.093243, -0.442772, 0.179480, 0.416468, -0.258982, -0.373518, 0.328565, 0.315550, -0.385426, -0.244793, 0.427249, 0.163996, -0.452308, -0.076316, 0.459531, -0.014800, -0.448549, 0.105754, 0.419711, -0.192939, -0.374078, 0.272879, 0.313380, -0.342369, -0.239950, 0.398603, 0.156643, -0.439286, -0.066713, 0.462730, -0.026305, -0.467920, 0.118737, 0.454562, -0.206913, -0.423095, 0.287314, 0.374675, -0.356714, -0.311140, 0.412303, 0.234932, -0.451808, -0.149012, 0.473577, 0.056738, -0.476660, 0.038263, 0.460836, -0.132237, -0.426633, 0.221450, 0.375316, -0.302339, -0.308827, 0.371652, 0.229725, -0.426578, -0.141081, 0.464861, 0.046360, -0.484893, 0.050714, 0.485783, -0.146302, -0.467391,
0.236604, 0.430342, -0.318009, -0.376003, 0.387240, 0.306433, -0.441480, -0.224309, 0.478496, 0.132819, -0.496722, -0.035539, 0.495329, -0.063705, -0.474260, 0.160986, 0.434238, -0.252433, -0.376743, 0.334387, 0.303953, -0.403540, -0.218666, 0.457074, 0.124196, -0.492772, -0.024233, 0.509115, -0.077289, -0.505339, 0.176350, 0.481472, -0.269007, -0.438341, 0.351543, 0.377541, -0.420625, -0.301377, 0.473426, 0.212776, -0.507753, -0.115176, 0.522129, 0.012394, -0.515860, 0.091524, 0.489064, -0.192462, -0.442673, 0.286397, 0.378406, -0.369557, -0.298698, 0.438572, 0.206611, -0.490615, -0.105719, 0.523512, -0.000032, -0.535830, 0.106478, 0.526947, -0.209399, -0.497075, 0.304689, 0.447260, -0.388516, -0.379345, 0.457477, 0.295906, -0.508733, -0.200146, 0.540132, 0.095781, -0.550290, 0.013107, 0.538662, -0.122226, -0.505554, 0.227248, 0.452130, -0.323980, -0.380370, 0.408524, 0.292991, -0.477438, -0.193348, 0.527876, 0.085311, -0.557706, 0.026897, 0.565595, -0.138853, -0.551072, 0.246110, 0.514550, -0.344380, -0.457317, 0.429695, 0.381490,
-0.498574, -0.289941, 0.548161, 0.186186, -0.576343, -0.074251, 0.581840, -0.041484, -0.564261, 0.156456, 0.524128, -0.266096, -0.462856, 0.366012, 0.382718, -0.452162, -0.286744, 0.521021, 0.178618, -0.569720, -0.062537, 0.596167, -0.056957, -0.599136, 0.175149, 0.578320, -0.287337, -0.534355, 0.389019, 0.468797, -0.476077, -0.384071, 0.544933, 0.283384, -0.592705, -0.170599, 0.617322, 0.050092, -0.617610, 0.073420, 0.593358, -0.195058, -0.545315, 0.309982, 0.475187, -0.413572, -0.385570, 0.501617, 0.279847, -0.570491, -0.162079, 0.617293, 0.036831, -0.639972, 0.090991, 0.637414, -0.216336, -0.609497, 0.334206, 0.557103, -0.439859, -0.482092, 0.528988, 0.387235, -0.597906, -0.276115, 0.643690, 0.152996, -0.664313, -0.022652, 0.658720, -0.109810, -0.626888, 0.239153, 0.569834, -0.360214, -0.489581, 0.468109, 0.389094, -0.558429, -0.272168, 0.627421, 0.143284, -0.672142, -0.007439, 0.690577, -0.130041, -0.681738, 0.263716, 0.645706, -0.388244, -0.583639, 0.498588, 0.497742, -0.590228, -0.391184, 0.659334, 0.267984, -0.702933, -0.132860,
0.719034, -0.008947, -0.706711, 0.151875, 0.666156, -0.290266, -0.598682, 0.418579, 0.506681, -0.531613, -0.393546, 0.624718, 0.263536, -0.693986, -0.121631, 0.736410, -0.026666, -0.750012, 0.175541, 0.733935, -0.319091, -0.688491, 0.451558, 0.615156, -0.567560, -0.516526, 0.662307, 0.396231, -0.731798, -0.258799, 0.772982, 0.109487, -0.783901, 0.045915, 0.763766, -0.201312, -0.713013, 0.350534, 0.633295, -0.487586, -0.527430, 0.606886, 0.399307, -0.703483, -0.253741, 0.773271, 0.096296, -0.813154, 0.066924, 0.821180, -0.229513, -0.796637, 0.385012, 0.740094, -0.527159, -0.653392, 0.650145, 0.539590, -0.748844, -0.402858, 0.819026, 0.248328, -0.857539, -0.081900, 0.862436, -0.089975, -0.833085, 0.260549, 0.770193, -0.423036, -0.675807, 0.570881, 0.553247, -0.698019, -0.406993, 0.799123, 0.242524, -0.869825, -0.066111, 0.906899, -0.115410, -0.908403, 0.294909, 0.873778, -0.465237, -0.803886, 0.619504, 0.700996, -0.751358, -0.568712, 0.855242, 0.411854, -0.926624, -0.236287, 0.962191, 0.048697, -0.959998, 0.143653, 0.919562, -0.333206,
-0.841905, 0.512400, 0.729540, -0.673967, -0.586384, 0.811227, 0.417634, -0.918357, -0.229581, 0.990632, 0.029378, -1.024633, 0.175235, 1.018396, -0.376212, -0.971518, 0.565524, 0.885194, -0.735472, -0.762195, 0.878995, 0.606788, -0.989960, -0.424591, 1.063414, 0.222371, -1.095800, -0.007801, 1.085127, -0.210824, -1.031064, 0.424910, 0.934988, -0.625891, -0.799960, 0.805568, 0.630628, -0.956436, -0.433080, 1.071991, 0.214625, -1.147008, 0.016467, 1.177764, -0.251280, -1.162207, 0.480580, 1.100077, -0.695178, -0.992944, 0.886293, 0.844181, -1.045891, -0.658864, 1.167034, 0.443611, -1.244153, -0.206348, 1.273308, -0.043977, -1.252363, 0.297722, 1.181113, -0.544911, -1.061327, 0.775626, 0.896720, -0.980387, -0.692849, 1.150536, 0.456926, -1.278596, -0.197588, 1.358580, -0.075430, -1.386259, 0.351637, 1.359368, -0.620185, -1.277733, 0.870282, 1.143324, -1.091615, -0.960227, 1.274761, 0.734533, -1.411575, -0.474141, 1.495534, 0.188503, -1.522034, 0.111721, 1.488600, -0.415038, -1.395054, 0.709554, 1.243556, -0.983423, -1.038590, 1.225307,
0.786843, -1.424833, -0.497003, 1.573012, 0.179470, -1.662626, 0.154000, 1.688545, -0.490711, -1.647992, 0.817497, 1.540700, -1.121215, -1.368991, 1.389249, 1.137761, -1.610010, -0.854360, 1.773419, 0.528375, -1.871318, -0.171325, 1.897854, -0.203724, -1.849757, 0.582612, 1.726547, -0.950600, -1.530636, 1.292912, 1.267312, -1.595294, -0.944640, 1.844578, 0.573229, -2.029213, -0.165916, 2.139750, -0.262649, -2.169266, 0.696505, 2.113714, -1.118924, -1.972162, 1.513033, 1.746931, -1.862426, -1.443620, 2.151800, 1.071007, -2.367561, -0.640830, 2.498393, 0.167457, -2.535756, 0.332555, 2.474297, -0.840992, -2.312171, 1.338593, 2.051231, -1.805717, -1.697104, 2.223045, 1.259130, -2.572291, -0.750165, 2.836910, 0.186253, -3.002752, 0.413810, 3.058668, -1.029046, -2.997026, 1.636942, 2.814118, -2.214180, -2.510452, 2.737399, 2.090904, -3.184021, -1.564736, 3.533029, 0.945458, -3.765759, -0.250547, 3.866605, -0.498970, -3.823663, 1.279057, 3.629270, -2.063335, -3.280401, 2.823821, 2.778957, -3.531746, -2.131873, 4.158405, 1.351089, -4.676017,
-0.453342, 5.058559, -0.540176, -5.282545, 1.604315, 5.327714, -2.710600, -5.177583, 3.827962, 4.819850, -4.923541, -4.246584, 5.963555, 3.454165, -6.914155, -2.442932, 7.742256, 1.216440, -8.416231, 0.219782, 8.906425, -1.860159, -9.185330, 3.702041, 9.227167, -5.750327, -9.006452, 8.024918, 8.494549, -10.573403, -7.652011, 13.494070, 6.410832, -16.980892, -4.629552, 21.419324, 1.962447, -27.610829, 2.599674, 37.352398, -12.744062, -54.977411, 45.443789, 89.539280, -177.665438, -123.067423, 441.204605, -192.351774};

/* 1024-point FFT of the chrp480 filter */
static const float32_t fftchrp480[2048] = {21.665056, 22.350368, 22.123668, 21.364952, 22.105722, 22.156526, 22.422432, 20.832701, 23.038011, 21.360377, 23.189513, 19.833817, 24.375908, 19.915810, 24.378972, 18.296289, 25.994190, 17.762930, 25.892543, 16.117009, 27.724860, 14.837581, 27.567589, 13.179750, 29.351947, 11.085804, 29.167531, 9.381282, 30.607305, 6.484793, 30.378814, 4.665619, 31.171524, 1.071234, 30.819371, -0.934926, 30.685454, -5.023765, 30.064129, -7.255395, 28.778640, -11.536920, 27.692750, -13.957321, 25.120263, -18.039855, 23.362800, -20.502030, 19.495328, -23.923496, 16.906840, -26.152775, 11.902526, -28.416083, 8.444079, -30.022776, 2.660509, -30.652611, -1.513905, -31.184761, -7.503330, -29.809366, -11.996486, -28.849349, -17.420105, -25.304953, -21.589751, -22.602239, -25.548691, -17.046695, -28.579643, -12.662985, -30.187720, -5.670424, -31.252279, -0.095397, -29.845144, 7.311224, -28.342397, 13.128942, -23.728842, 19.557644, -19.557570, 24.319678, -12.249381, 28.241332, -6.029107, 30.580439, 2.648291, 30.715024, 9.521780, 29.625085, 17.547262, 25.418846, 23.118409, 20.732612, 28.196697, 12.781728, 30.481008, 5.514898,
30.746337, -4.271111, 28.490712, -11.928953, 23.321946, -20.625641, 16.747953, -25.837363, 7.372045, -30.348676, -1.469146, -30.656863, -11.974173, -28.946924, -19.592604, -23.505365, -27.162633, -15.768631, -29.887709, -6.212627, -31.118326, 4.662388, -26.898202, 14.345470, -20.881332, 23.565671, -10.807144, 28.507656, -0.169868, 31.456795, 11.306629, 28.375990, 21.096418, 23.218887, 27.899881, 12.721023, 31.160344, 2.068872, 28.884098, -10.788930, 23.223171, -20.596170, 12.297012, -28.496616, 0.858784, -30.819276, -12.702596, -28.541792, -22.308318, -21.001534, -29.948073, -9.452672, -30.310138, 3.468662, -26.651115, 16.764046, -16.268613, 25.776183, -3.759317, 31.225762, 10.589340, 28.687615, 22.315690, 21.940418, 29.593674, 8.511391, 30.631611, -5.039125, 24.243355, -19.433655, 13.100659, -27.832743, -2.460402, -31.233093, -16.120001, -25.942100, -27.630452, -15.081414, -30.474064, 0.227593, -27.380224, 15.473057, -15.161689, 26.583740, -0.539574, 31.230799, 16.023144, 26.413639, 26.816796, 15.362097, 31.185079, -1.686378, 25.626547, -16.719092, 12.853766, -28.714438, -4.077909, -30.195450, -20.145546, -24.162892,
-29.359854, -8.642449, -30.111852, 8.195535, -19.698759, 23.874612, -4.073258, 30.549855, 14.766439, 27.624062, 26.806336, 14.586072, 31.281624, -3.658733, 22.634767, -20.446718, 7.319458, -30.476698, -12.446840, -28.181426, -26.260035, -16.366807, -31.053099, 3.407014, -22.839908, 20.301403, -5.783022, 30.955348, 13.818706, 27.173106, 28.130347, 13.862353, 29.967885, -7.131356, 19.908809, -23.661820, -0.214220, -31.273484, -18.875498, -23.986816, -30.817577, -6.521881, -26.892898, 14.433700, -12.212985, 28.784836, 10.149163, 29.233561, 26.089544, 16.298855, 30.884304, -5.708433, 19.088564, -23.735222, -1.413214, -31.423103, -22.002086, -21.390491, -30.953551, -1.955495, -23.608592, 20.440523, -3.961093, 30.269529, 18.679458, 25.370157, 30.132555, 4.985368, 26.111092, -17.067836, 5.742517, -30.532609, -16.372479, -25.880269, -30.834333, -6.403926, -25.360731, 16.910697, -6.390896, 30.631234, 18.188635, 25.069435, 30.262078, 5.083755, 24.710965, -19.495416, 2.578647, -30.354085, -20.726476, -23.480518, -30.949473, 0.431931, -20.954295, 22.420013, 3.499990, 31.286496, 24.948329, 17.488463, 30.509787, -6.936233,
13.653646, -27.841566, -11.339965, -28.450329, -30.064819, -9.422844, -25.535081, 16.689015, -4.146282, 30.909001, 22.076939, 21.963801, 30.413053, -2.606391, 17.207539, -26.401577, -10.316607, -28.825038, -29.157744, -10.510410, -25.813960, 17.750364, -1.860605, 30.381818, 23.843487, 20.483865, 29.871882, -7.679519, 12.289057, -28.160106, -16.628800, -26.745355, -30.419244, -1.857417, -20.034776, 23.906633, 9.175045, 29.798141, 28.863858, 9.783420, 25.075391, -19.056787, -2.517846, -30.639782, -26.484755, -15.709771, -27.904356, 14.569533, -2.810858, 30.328618, 24.210939, 19.672018, 29.202271, -10.990178, 6.586607, -29.730434, -22.597916, -21.903404, -29.610581, 8.600814, -8.724715, 29.409473, 21.905065, 22.675756, 29.591336, -7.561008, 9.177629, -29.609689, -22.194391, -22.196713, -29.346393, 7.988069, -7.895459, 30.279131, 23.397698, 20.545908, 28.779151, -9.960722, 4.836099, -31.105004, -25.324782, -17.645941, -27.497329, 13.450963, -0.016748, 31.544098, 27.610201, 13.282793, 24.869998, -18.201669, -6.391413, -30.854096, -29.623792, -7.203383, -20.163205, 23.580424, 13.922335, 28.156647, 30.402653, -0.684500,
12.781674, -28.461402, -21.645536, -22.587866, -28.695259, 10.013915, -2.627202, 31.219912, 28.035437, 13.598387, 23.224937, -19.631628, -9.470807, -29.957877, -31.018584, -1.423921, -13.246723, 27.410758, 21.404057, 23.076864, 28.390484, -12.372730, -0.656068, -30.469181, -29.804402, -10.216673, -18.745911, 24.585700, 15.834414, 26.064338, 30.806935, -6.678181, 2.816571, -30.766439, -27.492403, -13.208551, -21.781235, 22.791590, 15.375012, 26.807701, 29.983527, -5.508295, 3.687963, -31.300398, -28.664570, -11.656098, -19.778410, 23.155864, 17.233534, 26.357223, 29.349866, -10.028864, -0.855315, -30.398347, -30.506788, -7.605144, -14.226385, 27.677045, 22.124578, 20.804930, 26.656521, -16.507151, -10.500546, -29.430992, -30.237730, 2.618210, -5.148330, 30.793302, 29.372573, 11.068425, 16.914724, -25.232252, -20.877020, -22.966126, -26.750384, 16.663926, 10.605568, 28.569813, 30.573972, -3.820047, 1.468113, -31.558734, -29.931934, -6.646217, -12.862423, 27.739339, 26.063664, 17.822457, 20.933131, -22.770245, -17.996014, -24.487475, -28.021993, 14.221383, 10.706567, 29.348167, 29.803984, -5.604823, -0.707823, -31.127480,
-31.401632, -2.561838, -6.338977, 29.787590, 28.716962, 11.027528, 14.185507, -28.256580, -26.124416, -16.278709, -19.521912, 23.340964, 21.972760, 22.548018, 23.675879, -20.339284, -17.174379, -24.972166, -27.354548, 14.798134, 13.678056, 28.439585, 28.313247, -11.390976, -8.503287, -29.409289, -30.751789, 7.290769, 6.333369, 30.351743, 30.047173, -3.941852, -2.240312, -31.177373, -31.424725, 2.107356, 1.072340, 30.413293, 30.670752, 0.763158, 0.949606, -31.616491, -30.971214, -0.555779, -1.622444, 30.246713, 31.156998, 2.267481, 1.182457, -31.514924, -30.465240, -0.778491, -1.418369, 30.543474, 31.596856, 0.532427, -1.228302, -31.116666, -30.223402, 1.535124, 1.962166, 30.965730, 31.366027, -4.226111, -6.056323, -30.097742, -29.622069, 6.610641, 8.488617, 30.241000, 29.292776, -11.483213, -13.023435, -27.456550, -27.070734, 14.286507, 17.333774, 26.453878, 23.845399, -20.089027, -21.205821, -21.567225, -20.414742, 23.197215, 26.297786, 17.688993, 13.626398, -27.739889, -28.221000, -10.842757, -8.084434, 30.077759, 31.499644, 3.264183, -1.441763, -30.660758, -29.920090, 4.661653, 8.954204, 30.008532,
28.107321, -14.466932, -18.295442, -24.474047, -21.771173, 21.127219, 25.266686, 18.670706, 13.072065, -28.733794, -29.600853, -7.284088, -2.744087, 30.241457, 31.303912, -3.109308, -10.278650, -29.838676, -26.138891, 15.655246, 19.858694, 22.951763, 18.924918, -25.112139, -29.221468, -12.015603, -4.764468, 30.137131, 30.266782, -1.218138, -8.393889, -30.226094, -27.017630, 16.518662, 22.194007, 21.102715, 15.486536, -25.933831, -29.896978, -8.981156, 0.198941, 31.746482, 29.458319, -9.081773, -15.726374, -25.707715, -21.372221, 22.413422, 28.656982, 13.741225, 3.807542, -30.885031, -29.765771, 4.820146, 12.903942, 27.788672, 22.970142, -21.835109, -28.233725, -13.885360, -4.078099, 30.067133, 29.912546, -4.781619, -14.748899, -27.725118, -20.601373, 24.160546, 28.976320, 10.300846, 0.546313, -30.080425, -29.379964, 9.585342, 20.540984, 24.286404, 14.062696, -27.979258, -30.069460, -2.984620, 7.383278, 29.424254, 25.404078, -18.579573, -27.720492, -15.539119, -2.892376, 30.637517, 28.853635, -8.363446, -18.968248, -24.234289, -14.479898, 28.300510, 31.515818, 0.479673, -12.195697, -27.812168, -20.763228, 21.811157,
29.407526, 10.303203, -4.349432, -31.594522, -25.453888, 18.101194, 26.329846, 14.668973, 2.534788, -30.153478, -29.179678, 11.627877, 24.723135, 20.154317, 5.525913, -30.538165, -28.806366, 8.497671, 20.494431, 22.397875, 10.289325, -29.806276, -31.224623, 6.517565, 20.814726, 22.922059, 10.030844, -28.263630, -30.049437, 4.293335, 19.538061, 24.757203, 10.523049, -30.153219, -30.243834, 6.963110, 20.454521, 21.944422, 9.233949, -28.786717, -30.521962, 7.438978, 23.667822, 21.536636, 4.429261, -30.945055, -27.502494, 12.245273, 24.535412, 17.300592, 1.460199, -31.087607, -26.970841, 17.230834, 29.462597, 11.467528, -7.027257, -29.582062, -20.704466, 21.486109, 30.108160, 5.643619, -13.668964, -28.713964, -14.333161, 28.590905, 30.432188, -5.761588, -21.495862, -20.793506, -5.046058, 29.624389, 27.903035, -14.032865, -29.250369, -13.202147, 8.499050, 30.543982, 17.919107, -24.648823, -29.739536, 0.222560, 18.279452, 24.223772, 7.555906, -30.687322, -28.519373, 14.883247, 29.417347, 11.198588, -9.850133, -28.559365, -16.103191, 24.946780, 30.329045, -3.159475, -23.362362, -21.505655, 0.481788, 32.212975,
22.472799, -21.998203, -30.093159, -2.015323, 17.511688, 23.895567, 6.889809, -29.608543, -27.412943, 15.914072, 31.272322, 8.063325, -16.431730, -27.070109, -7.623445, 29.380614, 26.157524, -13.758240, -28.240104, -10.271935, 13.024027, 28.529402, 10.225892, -30.641636, -27.922361, 15.817833, 30.052393, 7.154538, -15.601982, -25.267855, -7.307731, 28.653348, 26.256050, -15.784165, -31.363092, -6.110706, 20.364366, 25.280673, 0.592901, -31.775433, -20.513827, 22.446086, 29.339614, -2.195163, -22.893625, -18.856662, 4.625343, 30.575366, 16.438669, -27.684370, -30.258326, 12.007318, 30.515086, 8.757922, -17.317629, -24.886428, -3.186078, 29.130975, 21.861699, -19.814196, -30.740480, 1.263864, 26.379089, 18.374485, -11.062330, -30.793190, -8.471198, 30.988100, 24.041261, -19.121232, -29.402983, 0.164373, 22.609690, 18.339612, -6.524865, -29.353437, -12.548907, 28.999534, 27.435012, -17.824598, -32.778574, 0.330426, 26.875167, 16.897939, -12.055866, -27.664082, -6.372074, 28.303563, 22.125448, -18.786855, -30.115953, 2.505686, 28.050217, 15.059209, -16.989992, -28.243512, 0.794483, 33.008590, 15.268137, -28.093010,
-26.226614, 15.215479, 28.879359, 1.636542, -22.618834, -17.527218, 9.433477, 28.053201, 6.827855, -30.544154, -21.644917, 24.675519, 31.093297, -12.387528, -32.839891, -2.793014, 26.633272, 16.784094, -14.217505, -26.027349, -1.244830, 28.335701, 16.042439, -23.325344, -26.833666, 12.374098, 31.389762, 1.829853, -29.010663, -15.996691, 20.557103, 27.009918, -8.137442, -32.587356, -5.441250, 31.698062, 17.312480, -24.675936, -25.135852, 13.043466, 27.516383, 0.882844, -24.194969, -14.499810, 16.001908, 25.425095, -4.612472, -31.908874, -7.824689, 33.085993, 19.102578, -29.044077, -27.335359, 20.720087, 31.241773, -9.666243, -30.297794, -2.257517, 24.751367, 13.203937, -15.515895, -21.618594, 3.975986, 26.441653, 8.252703, -27.211608, -19.567453, 24.069701, 28.590655, -17.678772, -34.325151, 9.080628, 36.240021, 0.479312, -34.286027, -9.731597, 28.849553, 17.542386, -20.660550, -23.035831, 10.673159, 25.669686, 0.062218, -25.262272, -10.518979, 21.975180, 19.794072, -16.260663, -27.179746, 8.785120, 32.204285, -0.340719, -34.642808, -8.243740, 34.502359, 16.183579, -31.987451, -22.804139, 27.453187, 27.588035,
-21.352951, -30.202572, 14.186824, 30.508233, -6.455665, -28.550708, -1.375825, 24.539864, 8.905222, -18.819459, -15.807325, 11.831354, 21.838712, -4.077568, -26.833560, -3.917063, 30.693001, 11.639539, -33.370481, -18.619233, 34.855653, 24.453458, -35.159111, -28.827630, 34.299904, 31.529912, -32.297318, -32.460333, 29.167812, 31.634457, -24.927437, -29.181579, 19.599427, 25.337433, -13.226063, -20.431271, 5.883359, 14.867319, 2.303384, -9.100645, -11.145437, 3.607865, 20.380444, 1.146484, -29.668625, -4.746527, 38.597637, 6.862487, -46.697744, -7.286247, 53.468073, 5.961682, -58.413590, -3.006012, 61.090963, -1.281639, -61.159970, 6.427899, 58.435557, -11.811519, -52.934330, 16.709366, 44.908548, -20.360915, -34.860454, 22.047456, 23.530828, -21.179605, -11.857516, 17.383996, 0.902884, -10.578103, 8.246771, 1.021188, -14.602156, 10.670005, 17.399787, -23.549706, -16.222231, 36.420103, 11.090997, -47.954910, -2.513360, 56.860047, -8.532383, -62.054021, 20.682116, 62.843892, -32.340771, -59.068275, 41.894172, 51.178648, -47.952847, -40.234868, 49.592162, 27.801148, -46.546741, -15.743827, 39.317296, 5.950560,
-29.156392, -0.009102, 17.916443, -1.101188, -7.767106, -2.755516, 0.816701, 10.766916, 1.301768, -21.239504, 2.198909, 31.849499, -11.016902, -40.053286, 23.716062, 43.593766, -37.917575, -41.006542, 50.720419, 32.013435, -59.287940, -17.697779, 61.488092, 0.389944, -56.443156, 16.750300, 44.843548, -30.395390, -28.916149, 37.825384, 12.008768, -37.637013, 2.153110, 30.195130, -10.384885, -17.674392, 10.913067, 3.627202, -3.952899, 7.864138, -8.204616, -13.266594, 21.682074, 10.628173, -32.009962, -0.256640, 35.392600, -15.198934, -29.895795, 31.360323, 16.180983, -43.320011, 2.498114, 47.121371, -21.121260, -41.078353, 34.375750, 26.486180, -38.363487, -7.417731, 31.990498, -10.428619, -17.525457, 21.538886, 0.040127, -22.489462, 14.190252, 13.279883, -19.857657, 2.453058, 14.621578, -18.537859, -0.168680, 28.411328, -18.171698, -27.590198, 33.255469, 15.542803, -38.818590, 3.841882, 32.040991, -23.518824, -14.916359, 35.941059, -6.261182, -36.136252, 23.261336, 23.945243, -29.296048, -4.378244, 22.033049, -14.248087, -4.871518, 23.776580, -14.259450, -19.865534, 26.259633, 4.176477, -25.008777, 16.060712,
10.418863, -31.139545, 11.178385, 33.381243, -29.737373, -20.981462, 36.233654, -0.764121, -27.227203, 21.703018, 6.910965, -31.697099, 14.633823, 25.827758, -26.384576, -7.229523, 22.162137, -14.159698, -4.195971, 26.599499, -17.670944, -22.868692, 31.055458, 4.499434, -27.873379, 18.636757, 9.173881, -33.532052, 14.997762, 31.401253, -31.025833, -13.039782, 29.621779, -11.173062, -11.614363, 27.048070, -12.078601, -25.049828, 26.727973, 6.403283, -22.848796, 17.178516, 2.471776, -30.455241, 21.628785, 24.315791, -33.770638, -2.013592, 25.592454, -22.404668, -1.985837, 32.995147, -21.614396, -22.623917, 29.340201, -1.753825, -15.884215, 23.309802, -9.316749, -26.752555, 28.175908, 9.286844, -26.638621, 16.833721, 5.125852, -32.611111, 21.151371, 26.058279, -32.932823, -1.464783, 21.304930, -23.160090, 5.052952, 29.297391, -25.874782, -12.232107, 24.722532, -14.701965, -2.174604, 29.978735, -23.958814, -20.830074, 32.404985, -6.035171, -15.754512, 29.156842, -12.838228, -29.545091, 29.884171, 6.704499, -21.080277, 20.237837, -6.080877, -28.194131, 27.995560, 9.991337, -25.051411, 18.742019, -0.827961, -32.580487,
27.096701, 18.723643, -30.233202, 10.940089, 7.221620, -29.800709, 20.921521, 20.589658, -27.925335, 8.159640, 6.882724, -29.260557, 22.475939, 22.159940, -31.865300, 7.008162, 11.691029, -30.451917, 18.858802, 25.293841, -29.874870, 3.542551, 10.357445, -27.329622, 20.009468, 21.841679, -29.980995, 7.702922, 8.663535, -31.052201, 22.432680, 23.658556, -30.976760, 7.267803, 7.840763, -29.382829, 22.355428, 19.113855, -26.851082, 12.517885, 0.334135, -30.863416, 28.320181, 15.176163, -27.161014, 17.811781, -2.986308, -31.529832, 28.434985, 10.461961, -20.212098, 21.438291, -12.311262, -27.242155, 31.198604, -0.263621, -13.749259, 29.187265, -20.077395, -25.229887, 30.292390, -7.297102, -4.599937, 29.540580, -25.814312, -14.452310, 23.376027, -19.616453, 9.452935, 30.373763, -32.100066, -3.813014, 15.976301, -27.300839, 18.816667, 23.780938, -27.908873, 9.901530, -0.618304, -30.198186, 29.793798, 10.218456, -21.045015, 24.437405, -14.690986, -28.183653, 30.237198, -4.160762, -4.767423, 29.309078, -27.211465, -13.020015, 21.659121, -22.774210, 14.448980, 28.765653, -31.481757, 3.842155, 5.625624, -29.942517,
26.808710, 12.868941, -19.565910, 23.183724, -17.421117, -26.348438, 30.977087, -8.593093, -1.087067, 31.426392, -28.890795, -8.839728, 14.795822, -25.893306, 22.546268, 20.883786, -27.021851, 16.905810, -8.733683, -30.765080, 30.933271, -0.549211, -5.727864, 29.364811, -28.002128, -11.170045, 17.500056, -25.998332, 21.431253, 23.844788, -27.796244, 14.789115, -8.601992, -29.031823, 29.673460, -3.827045, -1.222829, 30.843883, -30.954859, -7.749604, 14.207893, -28.421424, 24.390933, 18.521788, -21.186833, 21.108645, -18.568695, -24.290300, 28.062119, -14.807315, 9.312764, 30.491171, -30.574773, 4.056387, -0.519540, -29.956958, 30.348585, 2.489455, -6.751761, 30.893364, -29.681466, -11.667905, 15.156394, -26.936623, 24.758659, 16.937933, -18.926648, 23.867984, -22.585287, -22.132905, 25.063430, -19.649035, 16.323194, 26.155229, -26.305098, 14.433659, -13.516529, -27.447896, 29.496617, -11.646024, 8.579311, 30.550467, -30.001046, 6.167540, -5.406503, -29.539013, 30.473210, -4.878202, 3.060903, 31.685535, -31.483278, 0.775633, 0.142037, -30.346814, 30.170595, -0.218293, 0.007560, 31.246524, -31.835084, -1.407371,
2.443127, -30.983685, 30.053878, 1.853448, -0.718690, 30.528598, -31.641922, -0.695734, 1.362969, -31.622751, 30.528782, 0.914296, 0.939589, 30.124146, -31.024683, 2.522412, -2.889829, -31.701504, 30.918743, -3.329534, 5.275629, 29.675358, -29.550757, 8.004817, -9.799466, -30.133334, 29.653083, -10.684791, 12.347363, 27.778244, -26.085037, 15.389551, -18.333457, -25.471430, 24.679961, -19.950719, 21.161839, 22.284325, -18.934478, 23.470498, -26.467003, -16.270009, 14.271623, -28.402255, 28.888823, 11.303666, -6.760211, 29.392473, -30.749322, -2.063724, -1.563996, -31.708751, 30.829020, -4.963308, 9.554033, 28.671492, -26.788029, 14.906936, -19.262472, -25.155444, 22.182209, -22.145482, 24.880820, 17.264705, -11.791741, 28.209001, -30.849225, -7.010227, 2.197068, -31.313765, 30.060689, -3.937252, 10.884471, 28.555504, -26.785502, 16.808411, -21.085480, -23.234437, 17.357011, -24.851200, 28.715307, 10.590001, -4.303240, 31.350063, -31.236301, 2.005061, -9.388638, -28.785456, 25.475612, -17.159955, 23.327720, 21.439745, -15.404408, 27.084645, -29.399964, -7.077812, -1.847931, -30.840591, 30.190001, -9.688332,
16.577948, 26.131011, -19.332012, 23.259631, -28.885487, -11.634069, 3.676045, -31.446696, 30.226459, -5.244049, 14.911934, 26.436356, -21.117456, 23.255103, -28.329677, -13.745813, 3.793482, -30.176605, 29.729535, -7.297483, 16.969431, 26.688981, -19.893648, 23.979930, -28.689094, -9.653140, -1.695314, -30.968863, 29.313258, -11.955938, 20.633379, 22.758699, -12.657605, 27.618452, -31.403959, -1.513635, -9.303244, -29.989048, 23.280632, -19.481360, 27.759831, 13.335418, -2.143646, 31.584854, -29.366699, 9.561633, -20.813552, -22.066190, 11.822652, -29.031916, 31.450388, -0.087503, 12.827509, 27.556447, -19.064550, 24.160527, -30.683072, -7.740970, -5.412953, -30.379696, 24.010431, -18.594753, 28.317654, 13.579664, -0.545000, 31.354542, -27.168199, 13.526314, -25.442785, -17.604655, 4.739318, -31.260820, 29.085916, -9.696916, 22.893974, 20.184815, -7.215483, 30.723074, -30.175085, 7.478867, -21.250240, -21.642305, 8.155664, -30.187574, 30.650578, -6.982196, 20.850370, 22.118514, -7.716028, 29.923575, -30.533785, 8.149661, -21.796142, -21.532487, 5.937282, -30.007013, 29.674251, -10.818320, 23.934126, 19.611156,
-2.739287, 30.276548, -27.768720, 14.732078, -26.821409, -15.976048, -1.994239, -30.280523, 24.386189, -19.494705, 29.690870, 10.282667, 8.243313, 29.257215, -19.035401, 24.468039, -31.446669, -2.417382, -15.613864, -26.208615, 11.326503, -28.652815, 30.744375, -7.249861, 23.095050, 20.133759, -1.265208, 30.639024, -26.233455, 17.595748, -28.930005, -10.464048, -10.344334, -28.761712, 17.034896, -26.571752, 30.778542, -2.336355, 21.533688, 21.604755, -3.447291, 31.342776, -26.361742, 16.197651, -29.143481, -8.893221, -12.319377, -28.997455, 14.652371, -27.298308, 29.531136, -7.454471, 25.868443, 17.961568, 2.674442, 30.876817, -20.255502, 22.750501, -31.494419, 0.193269, -20.356327, -23.342700, 2.397298, -30.385994, 24.696986, -19.570339, 30.470205, 5.262268, 17.795176, 24.794597, -5.828188, 30.991396, -26.069995, 16.479502, -30.006903, -5.918716, -17.285121, -26.400420, 6.704166, -29.997901, 25.138462, -17.596208, 31.077822, 5.486817, 17.798703, 24.915114, -3.179354, 30.660546, -24.260812, 20.128608, -30.456166, -1.734636, -22.325490, -21.511924, -1.276036, -31.405569, 19.142488, -23.648448, 30.641938, -5.895858,
26.510279, 16.579356, 9.567124, 28.871168, -11.493016, 29.214771, -27.722059, 13.953172, -29.912185, -6.009639, -19.821243, -24.510702, 0.734508, -30.758430, 18.994488, -24.147959, 30.811859, -6.693036, 27.389796, 13.488850, 14.426913, 27.467365, -6.235249, 30.751635, -22.561096, 20.406827, -31.147935, 3.403770, -26.352464, -16.465637, -12.171238, -27.984610, 6.871982, -30.763596, 23.236075, -20.081141, 30.550542, -4.088542, 27.638078, 15.063188, 13.867051, 27.118374, -3.141826, 31.064304, -20.625449, 23.371513, -29.226420, 8.667655, -30.169218, -9.065213, -19.443991, -23.805899, -4.644233, -30.472858, 13.262821, -28.527294, 25.390556, -16.808838, 31.239063, -1.697347, 26.946575, 15.473160, 15.715092, 26.207013, -0.065750, 31.524735, -15.782275, 26.214141, -26.637631, 15.903737, -31.309151, -0.247227, -26.735972, -14.581090, -17.038493, -26.448331, -1.554157, -30.740750, 12.242370, -28.291978, 25.019933, -19.025420, 29.967219, -5.380490, 30.119883, 8.772653, 21.948171, 21.769340, 10.783951, 28.761969, -3.773641, 31.250885, -16.434835, 25.652724, -26.311201, 16.980863, -30.810054, 3.167109, -29.308129, -9.078301,
-23.062829, -21.433978, -11.863454, -28.068271, -0.031763, -31.315301, 13.203763, -27.997517, 22.336001, -21.078824, 29.716725, -10.341573, 30.415019, 1.674257, 28.528634, 13.047536, 20.608871, 22.973155, 11.633937, 28.531436, -0.324247, 31.397597, -10.831548, 28.468413, -20.679345, 23.701697, -27.269571, 14.118100, -30.592441, 4.972099, -30.547169, -6.592466, -26.395779, -15.333605, -20.436472, -23.978499, -11.086674, -28.454233, -2.365215, -31.149815, 8.241324, -29.874747, 15.939726, -26.273748, 24.037304, -20.243833, 27.896343, -12.241304, 31.196397, -4.040369, 30.192860, 5.374711, 28.311731, 12.825962, 23.180852, 20.785972, 17.309980, 25.270072, 9.924370, 29.863365, 2.096433, 30.396640, -5.349893, 30.966399, -13.029037, 27.802957, -18.708323, 24.793271, -24.614112, 19.067394, -27.456066, 13.616650, -30.697563, 6.845142, -30.467381, 0.330836, -30.874178, -6.040154, -28.018639, -12.364186, -25.962196, -17.262917, -21.339958, -22.477002, -17.496443, -25.334363, -12.096500, -28.916856, -7.231024, -29.647642, -1.947648, -31.434316, 3.238473, -30.325042, 7.744785, -30.415494, 12.695483, -27.973623, 16.051564, -26.627632,
20.379136, -23.434845, 22.485353, -20.985339, 25.956721, -17.580803, 26.930274, -14.374155, 29.437072, -11.178604, 29.535683, -7.541189, 31.063109, -4.821654, 30.607357, -1.045471, 31.209588, 1.085916, 30.516144, 4.747345, 30.300055, 6.309886, 29.632522, 9.642495, 28.747610, 10.748533, 28.287383, 13.579857, 26.918047, 14.390317, 26.754510, 16.593909, 25.111104, 17.275071, 25.248316, 18.776003, 23.554621, 19.463021, 23.930330, 20.241954, 22.406899, 21.012867, 22.918935, 21.105981, 21.763420, 21.968171, 22.298263, 21.461009};

/* 480-point Hanning window */
static const float32_t hann480[480] = {0.000000, 0.000043, 0.000172, 0.000387, 0.000688, 0.001075, 0.001548, 0.002106, 0.002750, 0.003480, 0.004295, 0.005196, 0.006182, 0.007252, 0.008407, 0.009647, 0.010972, 0.012380, 0.013873, 0.015449, 0.017108, 0.018850, 0.020676, 0.022583, 0.024573, 0.026645, 0.028798, 0.031032, 0.033347, 0.035742, 0.038217, 0.040772, 0.043405, 0.046117, 0.048908, 0.051775, 0.054720, 0.057742, 0.060839, 0.064013, 0.067261, 0.070583, 0.073980, 0.077450, 0.080992, 0.084607, 0.088293, 0.092050, 0.095877, 0.099774, 0.103740, 0.107773, 0.111875, 0.116043, 0.120277, 0.124576, 0.128940, 0.133368, 0.137859, 0.142412, 0.147027, 0.151702, 0.156438, 0.161232, 0.166085, 0.170995, 0.175962, 0.180985, 0.186062, 0.191194, 0.196379, 0.201616, 0.206904, 0.212243, 0.217631, 0.223068, 0.228552, 0.234083, 0.239660, 0.245282, 0.250947, 0.256656, 0.262406, 0.268197, 0.274028, 0.279898, 0.285806, 0.291750, 0.297731, 0.303746, 0.309795, 0.315877, 0.321990, 0.328134, 0.334308, 0.340510, 0.346740, 0.352996, 0.359277, 0.365582,
0.371911, 0.378261, 0.384633, 0.391024, 0.397435, 0.403862, 0.410307, 0.416767, 0.423241, 0.429728, 0.436227, 0.442738, 0.449258, 0.455787, 0.462324, 0.468867, 0.475415, 0.481968, 0.488523, 0.495081, 0.501640, 0.508198, 0.514755, 0.521309, 0.527860, 0.534406, 0.540946, 0.547479, 0.554003, 0.560519, 0.567024, 0.573517, 0.579998, 0.586465, 0.592917, 0.599354, 0.605773, 0.612174, 0.618555, 0.624917, 0.631256, 0.637573, 0.643867, 0.650136, 0.656379, 0.662595, 0.668783, 0.674942, 0.681070, 0.687168, 0.693234, 0.699266, 0.705264, 0.711227, 0.717153, 0.723042, 0.728892, 0.734704, 0.740474, 0.746204, 0.751891, 0.757535, 0.763134, 0.768688, 0.774196, 0.779657, 0.785069, 0.790433, 0.795747, 0.801009, 0.806220, 0.811378, 0.816483, 0.821533, 0.826528, 0.831467, 0.836349, 0.841172, 0.845937, 0.850643, 0.855288, 0.859872, 0.864395, 0.868854, 0.873250, 0.877582, 0.881849, 0.886050, 0.890184, 0.894252, 0.898252, 0.902183, 0.906045, 0.909837, 0.913559, 0.917209, 0.920788, 0.924294, 0.927727, 0.931087,
0.934373, 0.937583, 0.940719, 0.943779, 0.946762, 0.949668, 0.952497, 0.955248, 0.957921, 0.960515, 0.963030, 0.965465, 0.967820, 0.970095, 0.972289, 0.974401, 0.976432, 0.978381, 0.980247, 0.982031, 0.983732, 0.985350, 0.986884, 0.988335, 0.989701, 0.990983, 0.992181, 0.993294, 0.994322, 0.995265, 0.996123, 0.996895, 0.997582, 0.998184, 0.998699, 0.999129, 0.999473, 0.999731, 0.999903, 0.999989, 0.999989, 0.999903, 0.999731, 0.999473, 0.999129, 0.998699, 0.998184, 0.997582, 0.996895, 0.996123, 0.995265, 0.994322, 0.993294, 0.992181, 0.990983, 0.989701, 0.988335, 0.986884, 0.985350, 0.983732, 0.982031, 0.980247, 0.978381, 0.976432, 0.974401, 0.972289, 0.970095, 0.967820, 0.965465, 0.963030, 0.960515, 0.957921, 0.955248, 0.952497, 0.949668, 0.946762, 0.943779, 0.940719, 0.937583, 0.934373, 0.931087, 0.927727, 0.924294, 0.920788, 0.917209, 0.913559, 0.909837, 0.906045, 0.902183, 0.898252, 0.894252, 0.890184, 0.886050, 0.881849, 0.877582, 0.873250, 0.868854, 0.864395, 0.859872, 0.855288,
0.850643, 0.845937, 0.841172, 0.836349, 0.831467, 0.826528, 0.821533, 0.816483, 0.811378, 0.806220, 0.801009, 0.795747, 0.790433, 0.785069, 0.779657, 0.774196, 0.768688, 0.763134, 0.757535, 0.751891, 0.746204, 0.740474, 0.734704, 0.728892, 0.723042, 0.717153, 0.711227, 0.705264, 0.699266, 0.693234, 0.687168, 0.681070, 0.674942, 0.668783, 0.662595, 0.656379, 0.650136, 0.643867, 0.637573, 0.631256, 0.624917, 0.618555, 0.612174, 0.605773, 0.599354, 0.592917, 0.586465, 0.579998, 0.573517, 0.567024, 0.560519, 0.554003, 0.547479, 0.540946, 0.534406, 0.527860, 0.521309, 0.514755, 0.508198, 0.501640, 0.495081, 0.488523, 0.481968, 0.475415, 0.468867, 0.462324, 0.455787, 0.449258, 0.442738, 0.436227, 0.429728, 0.423241, 0.416767, 0.410307, 0.403862, 0.397435, 0.391024, 0.384633, 0.378261, 0.371911, 0.365582, 0.359277, 0.352996, 0.346740, 0.340510, 0.334308, 0.328134, 0.321990, 0.315877, 0.309795, 0.303746, 0.297731, 0.291750, 0.285806, 0.279898, 0.274028, 0.268197, 0.262406, 0.256656, 0.250947,
0.245282, 0.239660, 0.234083, 0.228552, 0.223068, 0.217631, 0.212243, 0.206904, 0.201616, 0.196379, 0.191194, 0.186062, 0.180985, 0.175962, 0.170995, 0.166085, 0.161232, 0.156438, 0.151702, 0.147027, 0.142412, 0.137859, 0.133368, 0.128940, 0.124576, 0.120277, 0.116043, 0.111875, 0.107773, 0.103740, 0.099774, 0.095877, 0.092050, 0.088293, 0.084607, 0.080992, 0.077450, 0.073980, 0.070583, 0.067261, 0.064013, 0.060839, 0.057742, 0.054720, 0.051775, 0.048908, 0.046117, 0.043405, 0.040772, 0.038217, 0.035742, 0.033347, 0.031032, 0.028798, 0.026645, 0.024573, 0.022583, 0.020676, 0.018850, 0.017108, 0.015449, 0.013873, 0.012380, 0.010972, 0.009647, 0.008407, 0.007252, 0.006182, 0.005196, 0.004295, 0.003480, 0.002750, 0.002106, 0.001548, 0.001075, 0.000688, 0.000387, 0.000172, 0.000043, 0.000000};

/**
* @brief  Compute the chirp-z transform of the signal in given frequency range.
* @param  x: input signal (real)
* @param  oup: transformed output magnitude squared
* @param  f1: start frequency as a fraction of fs
* @param  f2: end frequency as a fraction of fs
* @param  N: no. of elements in x
* @param  M: no. of output transform points. Should be such that N+M-1 is a power of 2.
* @param  useWindow: 0=no windowing, 1=Hanning window.
* @retval None
*/
static void czt(uint8_t x[], float32_t oup[], float32_t f1, float32_t f2, uint32_t N, uint32_t M, uint8_t useWindow)
{
	uint32_t L, i;
	float32_t theta0;			/* A = exp(j*theta0) */
	float32_t *chrp, *fftchrp;
	float32_t c1, s1, c2, s2;

	L = N + M - 1;
	theta0 = 2.0f*PI*f1;

	float32_t yY[2*L], vV[2*L];

	if(M == 545){
		chrp = (float32_t *)chrp545;
		fftchrp = (float32_t *)fftchrp545;
	}
	else{
		chrp = (float32_t *)chrp480;
		fftchrp = (float32_t *)fftchrp480;
	}

	/* yn = A^-n * W^(n^2/2) * xn */
	for(i = 0; i < N; i++){
		c1 = arm_cos_f32(-(float32_t)i*theta0);
		s1 = arm_sin_f32(-(float32_t)i*theta0);
		c2 = (i < M) ? chrp[2*i] : 0;
		s2 = (i < M) ? chrp[2*i+1] : 0;
		if(useWindow && i < 480){
			yY[2*i] = (c1*c2 - s1*s2) * ((float32_t)x[i] * hann480[i]);		/* real */
			yY[2*i+1] = (c1*s2 + c2*s1) * ((float32_t)x[i] * hann480[i]);	/* imaginary */
		}
		else{
			yY[2*i] = (c1*c2 - s1*s2) * x[i];		/* real */
			yY[2*i+1] = (c1*s2 + c2*s1) * x[i];		/* imaginary */
		}
	}
	for(i = N; i < L; i++){
		yY[2*i] = 0;
		yY[2*i+1] = 0;
	}

	/* FFT(yY) */
	arm_cfft_f32(&S_cfft_1024, yY, 0, 1);

	/* FFT(yY)*FFT(vV) */
	arm_cmplx_mult_cmplx_f32(yY, fftchrp, yY, L);

	/* gn = IFFT[FFT(yY)*FFT(vV)] */
	arm_cfft_f32(&S_cfft_1024, yY, 1, 1);

	/* oup[n] = W^(n^2/2)*gn */
	for(i = 0; i < M; i++){
		c1 = chrp[2*i];
		s1 = chrp[2*i+1];
		vV[2*i] = c1*yY[2*i] - s1*yY[2*i+1];
		vV[2*i+1] = c1*yY[2*i+1] + s1*yY[2*i];
	}

	arm_cmplx_mag_squared_f32(vV, oup, M);

	return;
}

/**
  * @brief  Calculate the 480-point dBVrms spectrum of the given channel signal.
  * @param  channel: input channel
  * @retval None
  */
void calcSpectrum(uint8_t channel)
{
	uint8_t inp[545];
	float32_t oup[480];
	uint8_t* CHx_ADC_vals;
	uint32_t i;

	if(channel == CHANNEL1)
		CHx_ADC_vals = (uint8_t *)CH1_ADC_vals;
	else
		CHx_ADC_vals = (uint8_t *)CH2_ADC_vals;

	/* zero-pad input signal */
	for(i = 0; i < ADC_TRIGBUF_SIZE; i++)
		inp[i] = CHx_ADC_vals[i];
	for(i = ADC_TRIGBUF_SIZE; i < 545; i++)
		inp[i] = 0;

	czt(inp, oup, 0, 0.5, 545, 480, 1);

	/* convert to 0.15 dB per div, subtract 61 to make values within display height */
	for(i = 0; i < 480; i++){
		if(i == 0)
			chSpectrum[i] = (10*log10(oup[i] + 0.000001f) - 61)/0.15f;
		else
			chSpectrum[i] = (10*log10(2*(oup[i] + 0.000001f)) - 61)/0.15f;
	}

	return;
}
